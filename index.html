<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="AkashaHub â€” Portal de Despertar. Saia da Matrix. Governe sua Realidade.">
    <title>AKASHA HUB | Portal de Despertar</title>

    <!-- âœ… OPT 1: preconnect antes de tudo -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- âœ… OPT 2: Fontes nÃ£o-bloqueantes (media trick) â€” evita render-blocking -->
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700;900&family=Cinzel:wght@400;600&family=Rajdhani:wght@300;400;600&display=swap" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700;900&family=Cinzel:wght@400;600&family=Rajdhani:wght@300;400;600&display=swap"></noscript>

    <style>
        :root {
            --void:       #06060F;
            --deep:       #0A0A18;
            --gold:       #C9A84C;
            --gold-bright:#FFD700;
            --gold-dim:   #8A6E2A;
            --matrix:     #00FF41;
            --matrix-dim: #003B0F;
            --cosmic:     #4A90E2;
            --cosmic-dim: #1A3A6A;
            --white-e:    rgba(255,255,255,0.85);
            --font-deco:  'Cinzel Decorative', serif;
            --font-title: 'Cinzel', serif;
            --font-body:  'Rajdhani', sans-serif;
        }

        *, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }

        html, body {
            width: 100%; height: 100%;
            overflow: hidden;
            background: var(--void);
            color: #fff;
            font-family: var(--font-body);
            cursor: none;
        }

        /* â”€â”€ CUSTOM CURSOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        /* âœ… OPT 3: will-change apenas no cursor (movimento constante) */
        #cursor {
            position: fixed;
            width: 12px; height: 12px;
            border-radius: 50%;
            background: var(--gold);
            box-shadow: 0 0 20px var(--gold), 0 0 40px rgba(201,168,76,0.4);
            pointer-events: none;
            z-index: 9999;
            transform: translate(-50%,-50%);
            transition: width .2s, height .2s, background .2s;
            mix-blend-mode: screen;
            will-change: left, top;
        }
        #cursor-ring {
            position: fixed;
            width: 40px; height: 40px;
            border: 1px solid rgba(201,168,76,0.5);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9998;
            transform: translate(-50%,-50%);
            transition: width .4s, height .4s;
            will-change: left, top;
        }
        body.hovering #cursor { width:20px; height:20px; background: var(--gold-bright); }
        body.hovering #cursor-ring { width:60px; height:60px; border-color: var(--gold); }

        #stage {
            position: fixed; inset: 0;
            width: 100%; height: 100%;
            z-index: 1;
        }

        #matrix-canvas {
            position: fixed; inset: 0;
            width: 100%; height: 100%;
            z-index: 2;
            opacity: 0.07;
            pointer-events: none;
        }

        .vignette {
            position: fixed; inset: 0; z-index: 3;
            background: radial-gradient(ellipse at center,
                transparent 25%,
                rgba(6,6,15,0.5) 65%,
                rgba(6,6,15,0.92) 100%);
            pointer-events: none;
        }

        .scanlines {
            position: fixed; inset: 0; z-index: 4;
            background: repeating-linear-gradient(0deg,
                rgba(0,0,0,0.03), rgba(0,0,0,0.03) 1px,
                transparent 1px, transparent 2px);
            pointer-events: none;
            opacity: 0.5;
        }

        .pyramids-bg {
            position: fixed;
            bottom: 0; left: 0; right: 0;
            height: 35vh;
            z-index: 2;
            pointer-events: none;
            background:
                url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 300'%3E%3Cpolygon points='120,300 360,60 600,300' fill='%230A0A18'/%3E%3Cpolygon points='320,300 520,100 720,300' fill='%230D0D20'/%3E%3Cpolygon points='750,300 1000,30 1250,300' fill='%230A0A18'/%3E%3Cpolygon points='1000,300 1180,110 1360,300' fill='%230D0D20'/%3E%3C/svg%3E")
                bottom/cover no-repeat;
            opacity: 0.6;
        }

        .stars-svg {
            position: fixed; inset: 0; z-index: 2;
            pointer-events: none;
            opacity: 0.6;
        }

        #ui {
            position: fixed; inset: 0; z-index: 10;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            pointer-events: none;
        }

        /* â”€â”€ LOADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        #loader {
            position: fixed; inset: 0; z-index: 1000;
            background: var(--void);
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            gap: 24px;
            transition: opacity 1s ease;
        }
        .loader-glyph {
            font-size: 3rem;
            animation: loaderPulse 1.5s ease-in-out infinite;
        }
        .loader-text {
            font-family: var(--font-title);
            font-size: 0.65rem;
            letter-spacing: 0.5em;
            color: var(--gold-dim);
            text-transform: uppercase;
        }
        .loader-bar {
            width: 180px; height: 1px;
            background: rgba(201,168,76,0.15);
            position: relative; overflow: hidden;
        }
        .loader-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--gold-dim), var(--gold-bright));
            width: 0%;
            box-shadow: 0 0 12px var(--gold);
            transition: width 0.4s ease;
        }
        @keyframes loaderPulse {
            0%,100% { opacity:0.4; transform:scale(1); }
            50% { opacity:1; transform:scale(1.1); }
        }

        /* â”€â”€ HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .header {
            position: absolute;
            top: 0; left: 0; right: 0;
            display: flex; align-items: center; justify-content: space-between;
            padding: 32px 48px;
            opacity: 0;
            transform: translateY(-20px);
        }
        .logo-mark {
            font-family: var(--font-deco);
            font-size: 1.1rem;
            letter-spacing: 0.4em;
            color: var(--gold);
            text-shadow: 0 0 30px rgba(201,168,76,0.6);
        }
        .nav-links {
            display: flex; gap: 36px;
            pointer-events: auto;
        }
        .nav-link {
            font-family: var(--font-body);
            font-size: 0.65rem;
            letter-spacing: 0.3em;
            color: rgba(255,255,255,0.4);
            text-decoration: none;
            text-transform: uppercase;
            transition: color 0.3s, text-shadow 0.3s;
            cursor: none;
        }
        .nav-link:hover {
            color: var(--gold);
            text-shadow: 0 0 20px rgba(201,168,76,0.5);
        }

        /* â”€â”€ HERO TEXT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .hero-block {
            text-align: center;
            pointer-events: none;
            position: relative;
            z-index: 2;
            margin-bottom: 10px;
        }
        .hero-eyebrow {
            font-family: var(--font-body);
            font-size: 0.6rem;
            letter-spacing: 0.6em;
            color: var(--matrix);
            text-transform: uppercase;
            opacity: 0;
            transform: translateY(10px);
            margin-bottom: 16px;
            text-shadow: 0 0 20px var(--matrix);
        }
        .hero-title {
            font-family: var(--font-deco);
            font-size: clamp(2.8rem, 7vw, 6.5rem);
            font-weight: 700;
            color: var(--gold);
            letter-spacing: 0.15em;
            line-height: 1;
            opacity: 0;
            transform: translateY(20px);
            text-shadow:
                0 0 40px rgba(201,168,76,0.5),
                0 0 80px rgba(201,168,76,0.2);
            margin-bottom: 8px;
        }
        .hero-subtitle {
            font-family: var(--font-title);
            font-size: clamp(0.6rem, 1.5vw, 0.85rem);
            letter-spacing: 0.6em;
            color: rgba(255,255,255,0.35);
            text-transform: uppercase;
            opacity: 0;
            transform: translateY(10px);
            margin-bottom: 48px;
        }

        /* â”€â”€ SPHERE CONTAINER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .sphere-area {
            position: relative;
            width: clamp(280px, 35vw, 500px);
            height: clamp(280px, 35vw, 500px);
            margin: 0 auto;
            touch-action: none;
        }

        /* â”€â”€ DEITY MARKERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .deity {
            position: absolute;
            display: flex; flex-direction: column; align-items: center;
            gap: 8px;
            pointer-events: auto;
            cursor: none;
            opacity: 0;
            transition: opacity 0.3s;
            -webkit-tap-highlight-color: transparent;
        }
        .deity-orb {
            width: 52px; height: 52px;
            border-radius: 50%;
            border: 1.5px solid var(--gold-dim);
            background: radial-gradient(ellipse at 35% 35%,
                rgba(201,168,76,0.15) 0%,
                rgba(6,6,15,0.9) 70%);
            display: flex; align-items: center; justify-content: center;
            font-size: 1.3rem;
            position: relative;
            transition: all 0.4s cubic-bezier(0.175,0.885,0.32,1.275);
            box-shadow:
                0 0 15px rgba(201,168,76,0.2),
                inset 0 0 20px rgba(201,168,76,0.05);
        }
        .deity-orb::before {
            content: '';
            position: absolute; inset: -4px;
            border-radius: 50%;
            border: 1px solid rgba(201,168,76,0.2);
            animation: orbRing 4s linear infinite;
        }
        .deity-orb::after {
            content: '';
            position: absolute; inset: -10px;
            border-radius: 50%;
            border: 1px dashed rgba(201,168,76,0.1);
            animation: orbRing 8s linear infinite reverse;
        }
        @keyframes orbRing {
            from { transform: rotate(0deg); }
            to   { transform: rotate(360deg); }
        }
        .deity:hover .deity-orb {
            border-color: var(--gold);
            background: radial-gradient(ellipse at 35% 35%,
                rgba(201,168,76,0.35) 0%,
                rgba(6,6,15,0.85) 70%);
            box-shadow:
                0 0 40px rgba(201,168,76,0.6),
                0 0 80px rgba(201,168,76,0.2),
                inset 0 0 30px rgba(201,168,76,0.15);
            transform: scale(1.15);
        }
        .deity-name {
            font-family: var(--font-title);
            font-size: 0.55rem;
            letter-spacing: 0.3em;
            color: var(--gold-dim);
            text-transform: uppercase;
            transition: color 0.3s;
            white-space: nowrap;
        }
        .deity-role {
            font-size: 0.48rem;
            letter-spacing: 0.2em;
            color: rgba(255,255,255,0.3);
            text-transform: uppercase;
            white-space: nowrap;
        }
        .deity:hover .deity-name { color: var(--gold-bright); text-shadow: 0 0 15px var(--gold); }
        .deity:hover .deity-role { color: rgba(255,255,255,0.6); }
        .deity-level {
            position: absolute;
            top: -4px; right: -4px;
            background: linear-gradient(135deg, var(--gold), var(--gold-bright));
            color: #000;
            font-size: 0.45rem;
            font-weight: 700;
            padding: 2px 5px;
            border-radius: 3px;
            letter-spacing: 0.05em;
        }
        .deity-anubis { bottom: -30px; left: 50%; transform: translateX(-50%); }
        .deity-horus  { top: -30px;   left: 50%; transform: translateX(-50%); }
        .deity-isis   { top: 50%; left: -70px;   transform: translateY(-50%); }
        .deity-ra     { top: 50%; right: -70px;  transform: translateY(-50%); }

        /* â”€â”€ MANIFESTO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .manifesto {
            position: absolute;
            bottom: 0; left: 0; right: 0;
            text-align: center;
            padding-bottom: 40px;
            pointer-events: none;
            opacity: 0;
            transform: translateY(15px);
        }
        .manifesto-lines {
            font-family: var(--font-body);
            font-size: clamp(0.6rem, 1.2vw, 0.75rem);
            letter-spacing: 0.25em;
            color: rgba(255,255,255,0.25);
            line-height: 2.2;
            margin-bottom: 28px;
        }
        .manifesto-lines em {
            color: rgba(201,168,76,0.5);
            font-style: normal;
        }
        .cta-btn {
            display: inline-block;
            font-family: var(--font-title);
            font-size: 0.65rem;
            letter-spacing: 0.4em;
            color: var(--gold);
            border: 1px solid rgba(201,168,76,0.4);
            padding: 14px 36px;
            text-transform: uppercase;
            text-decoration: none;
            pointer-events: auto;
            cursor: none;
            position: relative;
            transition: all 0.4s ease;
            background: transparent;
            overflow: hidden;
        }
        .cta-btn::before {
            content: '';
            position: absolute; inset: 0;
            background: linear-gradient(90deg, transparent, rgba(201,168,76,0.1), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }
        .cta-btn:hover {
            border-color: var(--gold);
            color: var(--gold-bright);
            box-shadow: 0 0 30px rgba(201,168,76,0.3), inset 0 0 30px rgba(201,168,76,0.05);
        }
        .cta-btn:hover::before { transform: translateX(100%); }
        .cta-btn:active { transform: scale(0.97); }

        /* â”€â”€ CORNER GLYPHS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .corner-glyph {
            position: fixed;
            font-size: 0.5rem;
            letter-spacing: 0.3em;
            color: rgba(201,168,76,0.2);
            font-family: var(--font-body);
            opacity: 0;
        }
        .corner-tl { top: 20px; left: 20px; }
        .corner-tr { top: 20px; right: 20px; text-align: right; }
        .corner-bl { bottom: 20px; left: 20px; }
        .corner-br { bottom: 20px; right: 20px; text-align: right; }

        /* â”€â”€ SIDE LINES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .side-line {
            position: fixed;
            background: linear-gradient(to bottom, transparent, rgba(201,168,76,0.3), transparent);
            width: 1px;
            height: 40%;
            top: 30%;
            opacity: 0;
        }
        .side-line-l { left: 32px; }
        .side-line-r { right: 32px; }

        #enigma {
            position: fixed;
            bottom: 80px;
            left: 50%; transform: translateX(-50%);
            font-family: var(--font-title);
            font-size: 0.7rem;
            letter-spacing: 0.3em;
            color: var(--matrix);
            text-shadow: 0 0 20px var(--matrix);
            opacity: 0;
            white-space: nowrap;
            z-index: 20;
            pointer-events: none;
            text-align: center;
        }

        #portal-overlay {
            position: fixed; inset: 0; z-index: 500;
            background: radial-gradient(ellipse at center, transparent 0%, rgba(6,6,15,0.98) 100%);
            opacity: 0; pointer-events: none;
            display: flex; align-items: center; justify-content: center;
            flex-direction: column; gap: 20px;
        }
        .portal-ring {
            position: absolute;
            border-radius: 50%;
            border: 1px solid var(--gold);
            opacity: 0;
        }
        #portal-name {
            font-family: var(--font-deco);
            font-size: clamp(1.5rem, 4vw, 3.5rem);
            color: var(--gold);
            letter-spacing: 0.3em;
            opacity: 0;
            text-shadow: 0 0 40px var(--gold);
            position: relative; z-index: 2;
        }
        #portal-sub {
            font-family: var(--font-body);
            font-size: 0.65rem;
            letter-spacing: 0.5em;
            color: rgba(255,255,255,0.4);
            opacity: 0;
            position: relative; z-index: 2;
        }

        #flash {
            position: fixed; inset: 0; z-index: 600;
            background: radial-gradient(ellipse at center, #fff 0%, var(--gold-bright) 100%);
            opacity: 0; pointer-events: none;
        }

        #phrase-display {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            font-family: var(--font-title);
            font-size: clamp(0.8rem, 2vw, 1.2rem);
            color: var(--gold);
            letter-spacing: 0.2em;
            text-align: center;
            opacity: 0;
            z-index: 20;
            pointer-events: none;
            text-shadow: 0 0 30px rgba(201,168,76,0.7);
            max-width: 600px;
            line-height: 1.8;
        }

        #sound-toggle {
            position: fixed;
            bottom: 32px; right: 48px;
            z-index: 50;
            pointer-events: auto;
            cursor: none;
            display: flex; align-items: center; gap: 8px;
            opacity: 0;
        }
        .sound-bars { display: flex; align-items: flex-end; gap: 2px; height: 14px; }
        .sound-bar {
            width: 2px;
            background: var(--gold-dim);
            border-radius: 1px;
            transition: height 0.2s, background 0.2s;
        }
        #sound-toggle.active .sound-bar { background: var(--gold); }
        #sound-toggle.active .sound-bar:nth-child(1) { animation: bar1 0.8s ease infinite; }
        #sound-toggle.active .sound-bar:nth-child(2) { animation: bar2 0.6s ease infinite; }
        #sound-toggle.active .sound-bar:nth-child(3) { animation: bar3 1.0s ease infinite; }
        #sound-toggle.active .sound-bar:nth-child(4) { animation: bar2 0.7s ease infinite; }
        @keyframes bar1 { 0%,100%{height:4px} 50%{height:14px} }
        @keyframes bar2 { 0%,100%{height:8px} 50%{height:4px}  }
        @keyframes bar3 { 0%,100%{height:12px} 50%{height:6px} }
        .sound-label { font-size: 0.5rem; letter-spacing: 0.3em; color: var(--gold-dim); }
        #sound-toggle:hover .sound-label { color: var(--gold); }

        /* â”€â”€ AUTH BUTTONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .auth-bar {
            position: fixed; top: 22px; left: 50%;
            transform: translateX(-50%);
            z-index: 200;
            display: flex; align-items: center; gap: 10px;
            opacity: 0; pointer-events: auto;
        }
        .auth-btn {
            font-family: var(--font-title);
            font-size: 0.58rem;
            letter-spacing: 0.35em;
            text-transform: uppercase;
            text-decoration: none;
            padding: 9px 22px;
            border-radius: 2px;
            cursor: none;
            transition: all 0.35s ease;
            display: inline-block;
            white-space: nowrap;
        }
        .auth-btn-login {
            color: var(--gold);
            border: 1px solid rgba(201,168,76,0.35);
            background: rgba(6,6,15,0.6);
            backdrop-filter: blur(10px);
        }
        .auth-btn-login:hover {
            border-color: var(--gold);
            background: rgba(201,168,76,0.08);
            box-shadow: 0 0 20px rgba(201,168,76,0.25);
            color: var(--gold-bright);
        }
        .auth-btn-register {
            color: #000;
            background: linear-gradient(135deg, var(--gold) 0%, var(--gold-bright) 100%);
            border: 1px solid var(--gold-bright);
            box-shadow: 0 0 20px rgba(201,168,76,0.3);
        }
        .auth-btn-register:hover {
            background: linear-gradient(135deg, var(--gold-bright) 0%, #fff8c0 100%);
            box-shadow: 0 0 35px rgba(255,215,0,0.5), 0 0 60px rgba(201,168,76,0.2);
            transform: scale(1.04);
        }
        .auth-divider { width: 1px; height: 18px; background: rgba(201,168,76,0.2); }

        /* â”€â”€ NAV MENU â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        #menu-toggle {
            position: fixed; top: 20px; right: 28px;
            z-index: 300;
            width: 44px; height: 44px;
            background: rgba(6,6,15,0.75);
            border: 1px solid rgba(201,168,76,0.3);
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            cursor: none; pointer-events: auto;
            transition: all 0.35s ease;
            backdrop-filter: blur(12px);
            opacity: 0;
        }
        #menu-toggle:hover {
            border-color: var(--gold);
            background: rgba(201,168,76,0.1);
            box-shadow: 0 0 25px rgba(201,168,76,0.35);
        }
        #menu-toggle svg { stroke: var(--gold); transition: stroke 0.2s; }
        #menu-toggle .bar-top,
        #menu-toggle .bar-mid,
        #menu-toggle .bar-bot {
            transition: transform 0.35s ease, opacity 0.25s ease;
            transform-origin: center;
        }
        #menu-toggle.open .bar-top { transform: rotate(45deg) translate(4px, 4px); }
        #menu-toggle.open .bar-mid { opacity: 0; transform: scaleX(0); }
        #menu-toggle.open .bar-bot { transform: rotate(-45deg) translate(4px, -4px); }

        #nav-overlay {
            position: fixed; inset: 0;
            background: rgba(6,6,15,0.5);
            backdrop-filter: blur(2px);
            z-index: 250;
            opacity: 0; visibility: hidden;
            transition: all 0.4s ease;
            pointer-events: none;
        }
        #nav-overlay.active { opacity: 1; visibility: visible; pointer-events: auto; }

        #nav-panel {
            position: fixed; top: 0; right: 0;
            width: 300px; height: 100vh;
            z-index: 280;
            background: linear-gradient(180deg, rgba(6,6,15,0.99) 0%, rgba(10,10,24,0.96) 100%);
            border-left: 1px solid rgba(201,168,76,0.2);
            backdrop-filter: blur(24px);
            padding: 88px 28px 40px;
            transform: translateX(100%);
            transition: transform 0.5s cubic-bezier(0.77,0,0.175,1);
            overflow-y: auto;
            pointer-events: auto;
        }
        #nav-panel.open { transform: translateX(0); }

        .nav-panel-header {
            font-family: var(--font-title);
            font-size: 0.6rem;
            letter-spacing: 0.5em;
            color: rgba(201,168,76,0.4);
            text-transform: uppercase;
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(201,168,76,0.15);
        }
        .nav-panel-link {
            display: flex; align-items: center; gap: 14px;
            padding: 13px 16px; margin-bottom: 6px;
            text-decoration: none;
            color: rgba(255,255,255,0.6);
            border: 1px solid transparent;
            border-radius: 4px;
            cursor: none;
            transition: all 0.3s ease;
            position: relative;
        }
        .nav-panel-link:hover {
            color: var(--gold-bright);
            border-color: rgba(201,168,76,0.25);
            background: rgba(201,168,76,0.06);
            transform: translateX(4px);
            box-shadow: 0 0 18px rgba(201,168,76,0.1);
        }
        .nav-panel-link:hover .nav-icon { color: var(--gold); }
        .nav-icon {
            font-size: 1rem; color: var(--gold-dim);
            width: 20px; text-align: center;
            transition: color 0.3s; flex-shrink: 0;
        }
        .nav-link-content { flex: 1; }
        .nav-link-title {
            font-family: var(--font-title);
            font-size: 0.75rem;
            letter-spacing: 0.15em;
            display: block; margin-bottom: 2px;
        }
        .nav-link-sub {
            font-size: 0.58rem; letter-spacing: 0.1em;
            color: rgba(255,255,255,0.3); display: block;
        }
        .nav-panel-divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(201,168,76,0.2), transparent);
            margin: 14px 0;
        }
        .nav-highlight { border-color: rgba(201,168,76,0.2) !important; background: rgba(201,168,76,0.04); }
        .nav-highlight .nav-link-title { color: var(--gold); }
        .nav-highlight::before {
            content: 'â˜…'; position: absolute;
            top: -7px; right: 10px;
            color: var(--gold); font-size: 0.6rem;
        }
        .nav-panel-footer {
            margin-top: 28px; padding-top: 18px;
            border-top: 1px solid rgba(201,168,76,0.1);
            font-size: 0.55rem; letter-spacing: 0.3em;
            color: rgba(255,255,255,0.2); text-align: center;
        }

        /* â”€â”€ RESPONSIVE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        @media (max-width: 768px) {
            body { cursor: auto; }
            #cursor, #cursor-ring { display: none; }
            a, button, .deity { cursor: pointer; }
            .header { padding: 16px 20px; justify-content: flex-start; }
            .logo-mark { font-size: 0.85rem; letter-spacing: 0.3em; }
            .nav-links { display: none; }
            .auth-bar { left: auto; right: 72px; transform: none; top: 18px; gap: 6px; }
            .auth-btn { padding: 7px 12px; font-size: 0.5rem; letter-spacing: 0.2em; }
            .auth-divider { display: none; }
            #menu-toggle { right: 16px; top: 16px; width: 40px; height: 40px; }
            #nav-panel { width: 80vw; max-width: 300px; padding: 80px 20px 32px; }
            .nav-panel-link { padding: 12px 14px; cursor: pointer; }
            .hero-block { margin-bottom: 4px; }
            .hero-subtitle { margin-bottom: 24px; letter-spacing: 0.3em; }
            .sphere-area { width: clamp(200px, 70vw, 300px); height: clamp(200px, 70vw, 300px); }
            .deity-anubis { bottom: -40px; }
            .deity-horus  { top: -40px; }
            .deity-isis   { left: -44px; }
            .deity-ra     { right: -44px; }
            .deity-orb    { width: 40px; height: 40px; font-size: 0.95rem; }
            .deity-name   { font-size: 0.48rem; }
            .deity-role   { display: none; }
            .manifesto { padding-bottom: 20px; }
            .manifesto-lines { font-size: 0.55rem; letter-spacing: 0.12em; line-height: 2; margin-bottom: 18px; }
            .cta-btn { padding: 11px 24px; font-size: 0.55rem; letter-spacing: 0.25em; cursor: pointer; }
            .corner-glyph { display: none; }
            .side-line    { display: none; }
            #enigma { bottom: 100px; font-size: 0.5rem; letter-spacing: 0.2em; }
            #sound-toggle { bottom: 18px; right: 16px; }
            .sound-label  { display: none; }
            .pyramids-bg  { height: 25vh; }
        }
        @media (max-width: 380px) {
            .sphere-area { width: 190px; height: 190px; }
            .deity-isis  { left: -38px; }
            .deity-ra    { right: -38px; }
            .deity-orb   { width: 34px; height: 34px; font-size: 0.8rem; }
            .auth-bar    { display: none; }
        }

        /* âœ… OPT 4: prefers-reduced-motion â€” acessibilidade + performance em low-power */
        @media (prefers-reduced-motion: reduce) {
            .deity-orb::before,
            .deity-orb::after,
            .loader-glyph,
            .sound-bar { animation: none !important; }
            * { transition-duration: 0.01ms !important; }
        }
    </style>
</head>
<body>

<div id="cursor"></div>
<div id="cursor-ring"></div>

<div id="loader">
    <div class="loader-glyph">ğ“‚€</div>
    <div class="loader-text">Inicializando Portal</div>
    <div class="loader-bar"><div class="loader-fill" id="loader-fill"></div></div>
</div>

<canvas id="stage"></canvas>
<canvas id="matrix-canvas"></canvas>

<svg class="stars-svg" xmlns="http://www.w3.org/2000/svg" id="stars-svg"></svg>

<div class="vignette"></div>
<div class="scanlines"></div>
<div class="pyramids-bg"></div>

<div class="corner-glyph corner-tl" id="c-tl">ğ“‚€ AKASHA<br>â—ˆ ONLINE</div>
<div class="corner-glyph corner-tr" id="c-tr">PORTAL ATIVO â—ˆ<br>ğ“¹ DESPERTAR</div>
<div class="corner-glyph corner-bl" id="c-bl">ğ“†£ CONSCIÃŠNCIA<br>â—ˆ EXPANDIDA</div>
<div class="corner-glyph corner-br" id="c-br">REALIDADE â—ˆ<br>ğ“‚‹ GOVERNADA</div>

<div class="side-line side-line-l" id="sl-l"></div>
<div class="side-line side-line-r" id="sl-r"></div>

<div id="enigma">â–¸ GIRE A ESFERA PARA ATIVAR â–¸</div>
<div id="phrase-display"></div>

<div id="portal-overlay">
    <div class="portal-ring" style="width:80px;height:80px"></div>
    <div class="portal-ring" style="width:180px;height:180px"></div>
    <div class="portal-ring" style="width:300px;height:300px"></div>
    <div class="portal-ring" style="width:450px;height:450px"></div>
    <div class="portal-ring" style="width:650px;height:650px"></div>
    <div id="portal-name">ANÃšBIS</div>
    <div id="portal-sub">PORTAL DIMENSIONAL ATIVADO</div>
</div>
<div id="flash"></div>

<div id="sound-toggle">
    <div class="sound-bars">
        <div class="sound-bar" style="height:4px"></div>
        <div class="sound-bar" style="height:10px"></div>
        <div class="sound-bar" style="height:6px"></div>
        <div class="sound-bar" style="height:12px"></div>
    </div>
    <span class="sound-label">SOM</span>
</div>

<div class="auth-bar" id="auth-bar">
    <a href="https://akashahub.com.br/login" class="auth-btn auth-btn-login">â—ˆ Entrar</a>
    <div class="auth-divider"></div>
    <a href="https://akashahub.com.br/cadastro" class="auth-btn auth-btn-register">Cadastrar</a>
</div>

<div id="nav-overlay"></div>

<button id="menu-toggle" aria-label="Menu de navegaÃ§Ã£o" aria-expanded="false">
    <svg width="18" height="14" viewBox="0 0 18 14" fill="none" stroke-width="1.8" stroke-linecap="round">
        <line class="bar-top" x1="0" y1="1"  x2="18" y2="1"/>
        <line class="bar-mid" x1="0" y1="7"  x2="18" y2="7"/>
        <line class="bar-bot" x1="0" y1="13" x2="18" y2="13"/>
    </svg>
</button>

<nav id="nav-panel" aria-label="Menu principal">
    <div class="nav-panel-header">â—ˆ NavegaÃ§Ã£o â—ˆ</div>
    <a href="https://akashahub.com.br/mentoria" class="nav-panel-link">
        <span class="nav-icon">ğ“¹</span>
        <div class="nav-link-content">
            <span class="nav-link-title">Mentoria</span>
            <span class="nav-link-sub">Programa de desenvolvimento</span>
        </div>
    </a>
    <a href="https://akashahub.com.br/partners" class="nav-panel-link">
        <span class="nav-icon">ğ“†£</span>
        <div class="nav-link-content">
            <span class="nav-link-title">Patrocinadores</span>
            <span class="nav-link-sub">Patrocinadores & afiliados</span>
        </div>
    </a>
    <a href="https://akashahub.com.br/vip" class="nav-panel-link">
        <span class="nav-icon">ğ“‡³</span>
        <div class="nav-link-content">
            <span class="nav-link-title">Presencial</span>
            <span class="nav-link-sub">ImersÃ£o & experiÃªncia VIP</span>
        </div>
    </a>
    <a href="https://akashahub.com.br/store" class="nav-panel-link">
        <span class="nav-icon">ğ“‹¹</span>
        <div class="nav-link-content">
            <span class="nav-link-title">Loja</span>
            <span class="nav-link-sub">Produtos & ferramentas</span>
        </div>
    </a>
    <div class="nav-panel-divider"></div>
    <a href="https://akashahub.com.br/doutrina" class="nav-panel-link">
        <span class="nav-icon">ğ“‚‹</span>
        <div class="nav-link-content">
            <span class="nav-link-title">Doutrina</span>
            <span class="nav-link-sub">Ãudios, livros & conteÃºdos</span>
        </div>
    </a>
    <a href="https://akashahub.com.br/livre/" class="nav-panel-link nav-highlight">
        <span class="nav-icon">ğ“‚€</span>
        <div class="nav-link-content">
            <span class="nav-link-title">SessÃ£o GrÃ¡tis</span>
            <span class="nav-link-sub">Grupos online abertos</span>
        </div>
    </a>
    <div class="nav-panel-footer">ğ“‚€ AKASHA EMPIRE</div>
</nav>

<div id="ui">
    <div class="header" id="header">
        <div class="logo-mark">ğ“‚€ AKASHA</div>
        <nav class="nav-links">
            <a href="https://akashahub.com.br/mentoria" class="nav-link">Mentoria</a>
            <a href="https://akashahub.com.br/vip" class="nav-link">Presencial VIP</a>
            <a href="https://akashahub.com.br/partners" class="nav-link">Parceiros</a>
            <a href="https://akashahub.com.br/livre/" class="nav-link">SessÃµes GrÃ¡tis</a>
        </nav>
    </div>

    <div class="hero-block">
        <div class="hero-eyebrow" id="eyebrow">â—ˆ Portal de Despertar â—ˆ</div>
        <h1 class="hero-title" id="hero-title">AKASHA HUB</h1>
        <p class="hero-subtitle" id="hero-sub">Biblioteca Global do Universo</p>
    </div>

    <div class="sphere-area" id="sphere-area"></div>

    <div class="manifesto" id="manifesto">
        <div class="manifesto-lines">
            Saia da Matrix. &nbsp;<em>Acesse a Biblioteca Global do Universo.</em><br>
            Desperte seu PropÃ³sito. &nbsp;<em>Governe sua Realidade.</em>
        </div>
        <a href="#" class="cta-btn" id="cta">INICIAR TRANSMISSÃƒO</a>
    </div>
</div>

<!-- âœ… OPT 5: defer â€” scripts NÃƒO bloqueiam o parsing do HTML -->
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  AKASHA ENGINE v4.1 â€” PERFORMANCE EDITION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const DEITIES = [
    { id:'anubis', name:'AnÃºbis', role:'Despertar',  level:'N1', emoji:'ğ“ƒ£', color:'#C9A84C', url:'https://pay.hotmart.com/N104491126Y', cls:'deity-anubis' },
    { id:'horus',  name:'HÃ³rus',  role:'VisÃ£o',      level:'N2', emoji:'ğ“¹', color:'#4A90E2', url:'https://pay.hotmart.com/O104491171B', cls:'deity-horus'  },
    { id:'isis',   name:'Ãsis',   role:'Sabedoria',  level:'N3', emoji:'ğ“‹¹', color:'#9B59B6', url:'https://pay.hotmart.com/F104491235U', cls:'deity-isis'   },
    { id:'ra',     name:'RÃ¡',     role:'LideranÃ§a',  level:'N4', emoji:'ğ“‡³', color:'#FFD700', url:'https://pay.hotmart.com/L104491291E', cls:'deity-ra'     }
];

const PHRASES = [
    "Quem se conhece governa sua realidade.",
    "Conhecimento sem aplicaÃ§Ã£o Ã© ilusÃ£o.",
    "VocÃª nÃ£o estÃ¡ clicando. VocÃª estÃ¡ ativando.",
    "A Matrix sÃ³ prende quem nÃ£o sabe que existe.",
    "ConsciÃªncia Ã© o Ãºnico poder que ninguÃ©m pode tirar de vocÃª.",
    "Aqui vocÃª transforma consciÃªncia em posiÃ§Ã£o no mundo.",
    "Saia da Matrix. Governe sua Realidade."
];

// â”€â”€ CUSTOM CURSOR â€” rAF em vez de setInterval â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// âœ… OPT 6: requestAnimationFrame sincroniza com o display (60fps), sem sobrecarga
const cursorEl   = document.getElementById('cursor');
const cursorRing = document.getElementById('cursor-ring');
let mx = 0, my = 0, rx = 0, ry = 0;

document.addEventListener('mousemove', e => { mx = e.clientX; my = e.clientY; }, { passive: true });

(function tickCursor() {
    rx += (mx - rx) * 0.12;
    ry += (my - ry) * 0.12;
    cursorEl.style.left   = mx + 'px';
    cursorEl.style.top    = my + 'px';
    cursorRing.style.left = rx + 'px';
    cursorRing.style.top  = ry + 'px';
    requestAnimationFrame(tickCursor);
})();

document.querySelectorAll('a, button, .deity, #sound-toggle').forEach(el => {
    el.addEventListener('mouseenter', () => document.body.classList.add('hovering'));
    el.addEventListener('mouseleave', () => document.body.classList.remove('hovering'));
});

// â”€â”€ GENERATE STARS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(function generateStars() {
    const svg = document.getElementById('stars-svg');
    const count = 180; // âœ… OPT 7: 200â†’180 estrelas (imperceptÃ­vel visualmente)
    let html = '';
    for (let i = 0; i < count; i++) {
        const x   = (Math.random() * 100).toFixed(1);
        const y   = (Math.random() * 70).toFixed(1);
        const r   = (Math.random() * 1.2 + 0.2).toFixed(2);
        const op  = (Math.random() * 0.6 + 0.1).toFixed(2);
        const dur = (Math.random() * 4 + 2).toFixed(1);
        const del = (Math.random() * 4).toFixed(1);
        html += `<circle cx="${x}%" cy="${y}%" r="${r}" fill="white" opacity="${op}">
            <animate attributeName="opacity" values="${op};${(op*0.2).toFixed(2)};${op}" dur="${dur}s" begin="${del}s" repeatCount="indefinite"/>
        </circle>`;
    }
    svg.innerHTML = html;
})();

// â”€â”€ MATRIX RAIN â€” pausa quando aba oculta â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// âœ… OPT 8: Page Visibility API economiza CPU/GPU quando fora da tela
(function matrixRain() {
    const canvas = document.getElementById('matrix-canvas');
    const ctx    = canvas.getContext('2d');

    function resize() {
        canvas.width  = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    resize();

    const chars = 'ã‚¢ã‚¦ã‚¨ã‚ªã‚«ã‚­ã‚¯ã‚±ã‚³01ã‚¢BCDEFGHIJKLMNOPQRSTUVWXYZğ“‚€ğ“¹ğ“†£ğ“‡³ğ“‹¹01';
    let cols  = Math.floor(canvas.width / 18);
    let drops = Array(cols).fill(1);
    let timer = null;

    function draw() {
        ctx.fillStyle = 'rgba(6,6,15,0.05)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = '#00FF41';
        ctx.font = '14px monospace';
        drops.forEach((y, i) => {
            const c = chars[Math.floor(Math.random() * chars.length)];
            ctx.fillText(c, i * 18, y * 18);
            if (y * 18 > canvas.height && Math.random() > 0.975) drops[i] = 0;
            drops[i]++;
        });
    }

    const start = () => { if (!timer) timer = setInterval(draw, 55); };
    const stop  = () => { clearInterval(timer); timer = null; };

    start();
    document.addEventListener('visibilitychange', () => document.hidden ? stop() : start());

    let resizeT;
    window.addEventListener('resize', () => {
        clearTimeout(resizeT);
        resizeT = setTimeout(() => {
            resize();
            cols  = Math.floor(canvas.width / 18);
            drops = Array(cols).fill(1);
        }, 200);
    }, { passive: true });
})();

// â”€â”€ THREE.JS â€” aguarda scripts defer carregarem â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// âœ… OPT 9: window.load garante que Three.js e GSAP estÃ£o prontos
window.addEventListener('load', function() {

    const threeCanvas = document.getElementById('stage');
    const renderer = new THREE.WebGLRenderer({
        canvas: threeCanvas, antialias: true, alpha: true,
        powerPreference: 'high-performance'
    });
    renderer.setSize(window.innerWidth, window.innerHeight);
    // âœ… OPT 10: pixelRatio limitado a 1.5 (era 2) â€” grande ganho em telas Retina/HiDPI
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 1.5));
    renderer.toneMapping = THREE.ACESFilmicToneMapping;
    renderer.toneMappingExposure = 1.0;

    const scene  = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 100);
    camera.position.set(0, 0, 7);

    scene.add(new THREE.AmbientLight(0x111122, 2));
    const goldLight = new THREE.PointLight(0xC9A84C, 3, 15);
    goldLight.position.set(2, 2, 4);
    scene.add(goldLight);
    const blueLight = new THREE.PointLight(0x4A90E2, 2, 15);
    blueLight.position.set(-3, -1, 3);
    scene.add(blueLight);

    const innerGeo = new THREE.IcosahedronGeometry(1.3, 2);
    const innerMat = new THREE.MeshStandardMaterial({
        color: 0x0A0A18, metalness: 0.1, roughness: 0.8,
        wireframe: false, emissive: 0x1A1A3A, emissiveIntensity: 0.5
    });
    const innerSphere = new THREE.Mesh(innerGeo, innerMat);
    scene.add(innerSphere);

    const outerShader = {
        vertex: `
            varying vec3 vNormal;
            varying vec2 vUv;
            void main() {
                vNormal = normalize(normalMatrix * normal);
                vUv = uv;
                gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
            }
        `,
        fragment: `
            uniform float uTime;
            varying vec3 vNormal;
            varying vec2 vUv;
            float fresnel(vec3 n) {
                return pow(1.0 - abs(dot(n, vec3(0.0, 0.0, 1.0))), 2.5);
            }
            void main() {
                float fr    = fresnel(vNormal);
                float pulse = sin(uTime * 1.2) * 0.5 + 0.5;
                float grid  = step(0.97, fract(vUv.y * 30.0 + uTime * 0.1))
                            + step(0.97, fract(vUv.x * 30.0 - uTime * 0.08));
                grid = clamp(grid, 0.0, 1.0);
                vec3 goldColor   = vec3(0.788, 0.659, 0.298);
                vec3 blueColor   = vec3(0.29, 0.565, 0.886);
                vec3 matrixColor = vec3(0.0, 1.0, 0.255);
                vec3 fresnelColor = mix(blueColor, goldColor, fr);
                vec3 baseColor    = mix(vec3(0.02, 0.02, 0.06), fresnelColor, fr * 0.7);
                vec3 gridColor    = mix(baseColor, goldColor * 0.6, grid * 0.4);
                vec3 final        = mix(gridColor, matrixColor * 0.3, grid * pulse * 0.15);
                float alpha = fr * 0.65 + grid * 0.2 + pulse * 0.05;
                gl_FragColor = vec4(final, clamp(alpha, 0.0, 0.8));
            }
        `
    };

    // âœ… OPT 11: Segmentos reduzidos de 64â†’48 â€” menos vÃ©rtices, visual idÃªntico
    const outerGeo = new THREE.SphereGeometry(1.65, 48, 48);
    const outerMat = new THREE.ShaderMaterial({
        vertexShader: outerShader.vertex,
        fragmentShader: outerShader.fragment,
        uniforms: { uTime: { value: 0 } },
        transparent: true, side: THREE.DoubleSide,
        blending: THREE.AdditiveBlending, depthWrite: false
    });
    const outerSphere = new THREE.Mesh(outerGeo, outerMat);
    scene.add(outerSphere);

    const sacredGeo = new THREE.IcosahedronGeometry(1.5, 1);
    const sacredMat = new THREE.MeshBasicMaterial({
        color: 0xC9A84C, wireframe: true, transparent: true, opacity: 0.08
    });
    const sacredMesh = new THREE.Mesh(sacredGeo, sacredMat);
    scene.add(sacredMesh);

    const rings = [];
    [1.9, 2.1, 2.4].forEach((r, i) => {
        const rGeo = new THREE.TorusGeometry(r, 0.004, 8, 120);
        const rMat = new THREE.MeshBasicMaterial({
            color: i === 0 ? 0xC9A84C : i === 1 ? 0x4A90E2 : 0x00FF41,
            transparent: true, opacity: 0.3 - i * 0.07
        });
        const ring = new THREE.Mesh(rGeo, rMat);
        ring.rotation.x = Math.PI / 2 + i * 0.3;
        ring.rotation.z = i * 0.5;
        scene.add(ring);
        rings.push({ mesh: ring, speed: 0.003 + i * 0.002, axis: i % 2 === 0 ? 'y' : 'x' });
    });

    // âœ… OPT 12: PartÃ­culas adaptativas â€” 400 em mobile, 700 em desktop
    const isMobile = window.innerWidth < 768;
    const PARTICLE_COUNT = isMobile ? 400 : 700;
    const partGeo  = new THREE.BufferGeometry();
    const partPos  = new Float32Array(PARTICLE_COUNT * 3);
    const partVel  = new Float32Array(PARTICLE_COUNT * 3);
    const partSize = new Float32Array(PARTICLE_COUNT);

    for (let i = 0; i < PARTICLE_COUNT; i++) {
        const theta = Math.random() * Math.PI * 2;
        const phi   = Math.acos(2 * Math.random() - 1);
        const r     = 1.8 + Math.random() * 1.2;
        partPos[i*3]   = r * Math.sin(phi) * Math.cos(theta);
        partPos[i*3+1] = r * Math.sin(phi) * Math.sin(theta);
        partPos[i*3+2] = r * Math.cos(phi);
        partVel[i*3]   = theta;
        partVel[i*3+1] = phi;
        partVel[i*3+2] = r;
        partSize[i] = Math.random() * 2 + 0.5;
    }
    partGeo.setAttribute('position', new THREE.BufferAttribute(partPos, 3));
    partGeo.setAttribute('size',     new THREE.BufferAttribute(partSize, 1));

    const partMat = new THREE.PointsMaterial({
        color: 0xC9A84C, size: 0.03, transparent: true, opacity: 0.6,
        sizeAttenuation: true, blending: THREE.AdditiveBlending, depthWrite: false
    });
    const particles = new THREE.Points(partGeo, partMat);
    scene.add(particles);

    let targetRotX = 0, targetRotY = 0;
    let currentRotX = 0, currentRotY = 0;
    let isNearSphere = false;
    let rotationSpeed = 0.004;
    let totalRotation = 0;
    let phrase360Shown = false;

    const raycaster = new THREE.Raycaster();
    const mouse = new THREE.Vector2(-10, -10);

    document.addEventListener('mousemove', e => {
        mouse.x =  (e.clientX / window.innerWidth)  * 2 - 1;
        mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
        targetRotX = mouse.y * 0.25;
        targetRotY = mouse.x * 0.25;
    }, { passive: true });

    document.addEventListener('touchmove', e => {
        if (e.touches.length === 1) {
            const t = e.touches[0];
            mouse.x =  (t.clientX / window.innerWidth)  * 2 - 1;
            mouse.y = -(t.clientY / window.innerHeight) * 2 + 1;
            targetRotX = mouse.y * 0.2;
            targetRotY = mouse.x * 0.2;
        }
    }, { passive: true });

    document.addEventListener('touchend', () => { pulseSphere(); playPulseSound(); });

    document.addEventListener('click', e => {
        raycaster.setFromCamera(mouse, camera);
        if (raycaster.intersectObjects([outerSphere, innerSphere]).length > 0) {
            pulseSphere(); playPulseSound();
        }
    });

    function pulseSphere() {
        gsap.to([outerSphere.scale, innerSphere.scale, sacredMesh.scale], {
            x: 1.12, y: 1.12, z: 1.12, duration: 0.15, ease: 'power2.out',
            onComplete: () => {
                gsap.to([outerSphere.scale, innerSphere.scale, sacredMesh.scale], {
                    x: 1, y: 1, z: 1, duration: 0.4, ease: 'elastic.out(1, 0.5)'
                });
            }
        });
        gsap.to(goldLight, { intensity: 8, duration: 0.2, yoyo: true, repeat: 1 });
    }

    // â”€â”€ SOUND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let audioCtx = null, soundOn = false, ambientOsc = null;

    function initAudio() {
        if (audioCtx) return;
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    }
    function startAmbient() {
        if (!audioCtx || ambientOsc) return;
        const master = audioCtx.createGain();
        master.gain.value = 0.04;
        master.connect(audioCtx.destination);
        [55, 110, 165].forEach((freq, i) => {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.value = freq;
            gain.gain.value = 1 - i * 0.25;
            osc.connect(gain); gain.connect(master); osc.start();
        });
        ambientOsc = master;
    }
    function stopAmbient() {
        if (!ambientOsc) return;
        ambientOsc.gain.setTargetAtTime(0, audioCtx.currentTime, 0.5);
        setTimeout(() => { ambientOsc = null; }, 1000);
    }
    function playPulseSound() {
        if (!audioCtx || !soundOn) return;
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = 'sine';
        osc.frequency.setValueAtTime(432, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(216, audioCtx.currentTime + 0.4);
        gain.gain.setValueAtTime(0.08, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.5);
        osc.connect(gain); gain.connect(audioCtx.destination);
        osc.start(); osc.stop(audioCtx.currentTime + 0.5);
    }

    document.getElementById('sound-toggle').addEventListener('click', () => {
        initAudio();
        soundOn = !soundOn;
        document.getElementById('sound-toggle').classList.toggle('active', soundOn);
        soundOn ? startAmbient() : stopAmbient();
    });

    // â”€â”€ BUILD DEITY MARKERS â€” DocumentFragment (1 sÃ³ reflow) â”€â”€â”€â”€â”€â”€
    // âœ… OPT 13: Fragment agrupa inserÃ§Ãµes DOM, evitando layout thrashing
    const sphereArea = document.getElementById('sphere-area');
    const fragment = document.createDocumentFragment();

    DEITIES.forEach(d => {
        const el = document.createElement('div');
        el.className = `deity ${d.cls}`;
        el.id = `deity-${d.id}`;
        el.setAttribute('role', 'button');
        el.setAttribute('tabindex', '0');
        el.setAttribute('aria-label', `Portal ${d.name} â€” NÃ­vel ${d.level}`);
        el.innerHTML = `
            <div class="deity-orb" style="border-color:${d.color}33">
                <span style="filter:drop-shadow(0 0 8px ${d.color})">${d.emoji}</span>
                <div class="deity-level">${d.level}</div>
            </div>
            <div class="deity-name">${d.name}</div>
            <div class="deity-role">${d.role}</div>
        `;
        el.addEventListener('click',   () => activatePortal(d));
        el.addEventListener('keydown', e => { if (e.key==='Enter'||e.key===' ') activatePortal(d); });
        fragment.appendChild(el);
    });
    sphereArea.appendChild(fragment);

    DEITIES.forEach(d => {
        gsap.to(`#deity-${d.id}`, {
            y: '+=8', repeat: -1, yoyo: true,
            duration: 2 + Math.random() * 1.5,
            ease: 'sine.inOut', delay: Math.random() * 2
        });
    });

    // â”€â”€ PORTAL TRANSITION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let isTransitioning = false;

    function activatePortal(deity) {
        if (isTransitioning) return;
        isTransitioning = true;
        if (soundOn && audioCtx) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(111, audioCtx.currentTime);
            osc.frequency.linearRampToValueAtTime(432, audioCtx.currentTime + 2);
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 3);
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.start(); osc.stop(audioCtx.currentTime + 3);
        }
        document.getElementById('portal-name').textContent = deity.name.toUpperCase();
        document.getElementById('portal-name').style.color = deity.color;
        document.getElementById('portal-name').style.textShadow = `0 0 40px ${deity.color}`;

        const overlay = document.getElementById('portal-overlay');
        const tl = gsap.timeline();
        tl.to(overlay, { opacity: 1, duration: 0.6, pointerEvents: 'auto' })
          .to('.portal-ring', { opacity: 0.8, scale: 2, duration: 1.5, stagger: 0.12, ease: 'power2.out' }, 0.2)
          .to('#portal-name', { opacity: 1, duration: 0.8, ease: 'power2.out' }, 0.8)
          .to('#portal-sub',  { opacity: 1, duration: 0.6 }, 1.2)
          .to([outerSphere.scale, innerSphere.scale], { x: 0.01, y: 0.01, z: 0.01, duration: 1.5, ease: 'power2.in' }, 0.5)
          .to('#flash', { opacity: 1, duration: 0.5, ease: 'power2.in' }, 2.8)
          .call(() => { window.location.href = deity.url; }, null, 3.4);
    }

    function showPhrase(index) {
        const el = document.getElementById('phrase-display');
        const p  = PHRASES[index !== undefined ? index : Math.floor(Math.random() * PHRASES.length)];
        if (el._gsapTween) el._gsapTween.kill();
        el.textContent = p;
        el._gsapTween = gsap.timeline()
            .to(el, { opacity: 1, duration: 0.8, ease: 'power2.out' })
            .to(el, { opacity: 0, duration: 0.8, ease: 'power2.in', delay: 3 });
    }

    setInterval(() => { if (!isTransitioning) showPhrase(); }, 12000);

    // â”€â”€ RENDER LOOP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const clock = new THREE.Clock();
    let animId;

    function animate() {
        animId = requestAnimationFrame(animate);
        const t = clock.getElapsedTime();

        outerMat.uniforms.uTime.value = t;

        raycaster.setFromCamera(mouse, camera);
        isNearSphere = raycaster.intersectObject(outerSphere).length > 0;
        const target = isNearSphere ? 0.0008 : 0.004;
        rotationSpeed += (target - rotationSpeed) * 0.05;

        currentRotX += (targetRotX - currentRotX) * 0.04;
        currentRotY += (targetRotY - currentRotY) * 0.04;

        innerSphere.rotation.y = t * rotationSpeed * 250 + currentRotY;
        innerSphere.rotation.x = currentRotX * 0.5;
        outerSphere.rotation.y = t * rotationSpeed * 200 + currentRotY;
        outerSphere.rotation.x = currentRotX * 0.3;
        sacredMesh.rotation.y  = -t * 0.006 + currentRotY * 0.5;
        sacredMesh.rotation.x  = t * 0.004;

        totalRotation += rotationSpeed;
        if (totalRotation > Math.PI * 2 && !phrase360Shown) {
            phrase360Shown = true;
            setTimeout(() => showPhrase(0), 500);
            setTimeout(() => { phrase360Shown = false; totalRotation = 0; }, 15000);
        }

        rings.forEach(r => { r.mesh.rotation[r.axis] += r.speed; });

        const pos = partGeo.attributes.position.array;
        for (let i = 0; i < PARTICLE_COUNT; i++) {
            partVel[i*3] += 0.003 + (i % 5) * 0.0003;
            const theta = partVel[i*3];
            const phi   = partVel[i*3+1];
            const r     = partVel[i*3+2];
            pos[i*3]   = r * Math.sin(phi) * Math.cos(theta);
            pos[i*3+1] = r * Math.sin(phi) * Math.sin(theta) + Math.sin(t * 0.3 + i) * 0.05;
            pos[i*3+2] = r * Math.cos(phi);
        }
        partGeo.attributes.position.needsUpdate = true;

        goldLight.intensity = 2.5 + Math.sin(t * 1.5) * 0.8;
        blueLight.intensity = 1.8 + Math.cos(t * 1.1) * 0.6;

        renderer.render(scene, camera);
    }

    // âœ… OPT 14: Pausa o loop Three.js quando aba estÃ¡ em background
    document.addEventListener('visibilitychange', () => {
        if (document.hidden) { cancelAnimationFrame(animId); clock.stop(); }
        else { clock.start(); animate(); }
    });

    // â”€â”€ INTRO SEQUENCE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const tl = gsap.timeline({ defaults: { ease: 'power3.out' } });
    let p = 0;
    const fillEl = document.getElementById('loader-fill');
    const loaderTimer = setInterval(() => {
        p = Math.min(p + Math.random() * 18, 100);
        fillEl.style.width = p + '%';
        if (p >= 100) {
            clearInterval(loaderTimer);
            tl.to('#loader', { opacity: 0, duration: 1, delay: 0.4,
                onComplete: () => { document.getElementById('loader').remove(); }
            });
        }
    }, 120);

    tl.to('#eyebrow',      { opacity: 1, y: 0, duration: 1.2, delay: 2 })
      .to('#hero-title',   { opacity: 1, y: 0, duration: 1.2 }, '-=0.6')
      .to('#hero-sub',     { opacity: 1, y: 0, duration: 1   }, '-=0.7')
      .to('#header',       { opacity: 1, y: 0, duration: 1   }, '-=0.5')
      .to('#manifesto',    { opacity: 1, y: 0, duration: 1   }, '-=0.5')
      .to('.corner-glyph', { opacity: 1, duration: 1, stagger: 0.15 }, '-=0.5')
      .to('.side-line',    { opacity: 1, duration: 1.5 }, '-=0.5')
      .to('#enigma',       { opacity: 0.7, duration: 1 }, '-=0.3')
      .to('#sound-toggle', { opacity: 0.7, duration: 1 }, '-=0.5')
      .to('#auth-bar',     { opacity: 1, duration: 0.8 }, '-=0.6')
      .to('#menu-toggle',  { opacity: 0.9, duration: 0.8 }, '-=0.6');

    DEITIES.forEach(d => {
        tl.to(`#deity-${d.id}`, { opacity: 1, duration: 0.8 }, '>-0.4');
    });

    setTimeout(() => showPhrase(6), 5000);

    // â”€â”€ NAV MENU â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const menuToggle = document.getElementById('menu-toggle');
    const navPanel   = document.getElementById('nav-panel');
    const navOverlay = document.getElementById('nav-overlay');

    const openNav  = () => { menuToggle.classList.add('open'); navPanel.classList.add('open'); navOverlay.classList.add('active'); menuToggle.setAttribute('aria-expanded', 'true'); };
    const closeNav = () => { menuToggle.classList.remove('open'); navPanel.classList.remove('open'); navOverlay.classList.remove('active'); menuToggle.setAttribute('aria-expanded', 'false'); };

    menuToggle.addEventListener('click', () => menuToggle.classList.contains('open') ? closeNav() : openNav());
    navOverlay.addEventListener('click', closeNav);
    document.addEventListener('keydown', e => { if (e.key === 'Escape') closeNav(); });

    document.querySelectorAll('.nav-panel-link, .auth-btn, #menu-toggle').forEach(el => {
        el.addEventListener('mouseenter', () => document.body.classList.add('hovering'));
        el.addEventListener('mouseleave', () => document.body.classList.remove('hovering'));
    });

    // âœ… OPT 15: passive:true no resize â€” nÃ£o bloqueia scroll
    let resizeTimer;
    window.addEventListener('resize', () => {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(() => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }, 150);
    }, { passive: true });

    animate();
});
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>AKASHA | O Império Global</title>
    
    <!-- Fontes -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Rajdhani:wght@300;500;600&display=swap" rel="stylesheet">

    <style>
        :root {
            --c-void: #000000;
            --c-gold: #d4af37;
            --c-gold-bright: #ffd700;
            --c-gold-glow: #ffdf80;
            --c-blue: #4aa3ff;
            --c-cyan: #00ffff;
            --font-head: 'Cinzel', serif;
            --font-tech: 'Rajdhani', sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        html { scroll-behavior: smooth; }
        
        body { 
            background-color: var(--c-void); 
            color: #fff; 
            font-family: var(--font-tech); 
            overflow-x: hidden; 
            overscroll-behavior: none;
        }

        /* CANVAS */
        #stage { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100vw; 
            height: 100vh; 
            z-index: 1; 
            outline: none; 
        }

        /* SCROLL CONTROL */
        .scroll-track { 
            height: 500vh; 
            position: relative; 
            z-index: 2; 
            pointer-events: none; 
        }

        /* UI LAYERS */
        .ui-layer {
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%;
            z-index: 10; 
            pointer-events: none;
            display: flex; 
            flex-direction: column;
            justify-content: center; 
            align-items: center;
            transition: opacity 1s ease;
        }

        /* ══════════════════════════════════════════════════════════════
           MENUS DE NAVEGAÇÃO
           ══════════════════════════════════════════════════════════════ */

        /* Container dos Menus */
        .nav-menus {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 100;
            pointer-events: none;
        }

        /* Menu Toggle Buttons */
        .menu-toggle {
            position: fixed;
            top: 25px;
            width: 50px;
            height: 50px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid var(--c-gold);
            border-radius: 50%;
            cursor: pointer;
            pointer-events: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            backdrop-filter: blur(10px);
            z-index: 102;
        }

        .menu-toggle:hover {
            transform: scale(1.1);
            background: var(--c-gold);
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.6);
        }

        .menu-toggle:hover svg {
            stroke: #000;
        }

        .menu-toggle svg {
            width: 24px;
            height: 24px;
            stroke: var(--c-gold);
            stroke-width: 2;
            fill: none;
            transition: all 0.3s ease;
        }

        .menu-toggle-left {
            left: 25px;
        }

        .menu-toggle-right {
            right: 25px;
        }

        /* Menu Panels */
        .menu-panel {
            position: fixed;
            top: 0;
            height: 100vh;
            width: 320px;
            background: linear-gradient(180deg, rgba(0,0,0,0.98) 0%, rgba(10,10,15,0.95) 100%);
            border: 1px solid rgba(212, 175, 55, 0.3);
            backdrop-filter: blur(20px);
            padding: 100px 30px 40px;
            transform: translateX(-100%);
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            pointer-events: auto;
            z-index: 101;
            overflow-y: auto;
        }

        .menu-panel.right {
            right: 0;
            left: auto;
            transform: translateX(100%);
            border-left: 1px solid rgba(212, 175, 55, 0.3);
            border-right: none;
        }

        .menu-panel.open {
            transform: translateX(0);
        }

        .menu-panel.right.open {
            transform: translateX(0);
        }

        /* Menu Header */
        .menu-header {
            font-family: var(--font-head);
            font-size: 1.2rem;
            color: var(--c-gold);
            letter-spacing: 0.3em;
            text-transform: uppercase;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(212, 175, 55, 0.3);
            text-align: center;
        }

        /* Menu Items */
        .menu-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 20px;
            margin-bottom: 10px;
            background: rgba(212, 175, 55, 0.05);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: #fff;
        }

        .menu-item:hover {
            background: rgba(212, 175, 55, 0.15);
            border-color: var(--c-gold);
            transform: translateX(5px);
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.2);
        }

        .menu-item-icon {
            width: 40px;
            height: 40px;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid var(--c-gold);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .menu-item-icon svg {
            width: 22px;
            height: 22px;
        }

        .menu-item-content {
            flex: 1;
        }

        .menu-item-title {
            font-family: var(--font-head);
            font-size: 0.9rem;
            color: var(--c-gold);
            letter-spacing: 0.15em;
            margin-bottom: 3px;
        }

        .menu-item-subtitle {
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.6);
            letter-spacing: 0.1em;
        }

        .menu-item-level {
            background: linear-gradient(135deg, var(--c-gold) 0%, var(--c-gold-bright) 100%);
            color: #000;
            font-size: 0.6rem;
            font-weight: 700;
            padding: 4px 8px;
            border-radius: 4px;
            letter-spacing: 0.05em;
        }

        /* Menu Overlay */
        .menu-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s ease;
            pointer-events: none;
            z-index: 100;
        }

        .menu-overlay.active {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }

        /* Menu Footer */
        .menu-footer {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(212, 175, 55, 0.2);
            text-align: center;
        }

        .menu-footer-text {
            font-size: 0.65rem;
            color: rgba(255, 255, 255, 0.4);
            letter-spacing: 0.2em;
        }

        /* Close button inside panel */
        .menu-close {
            position: absolute;
            top: 25px;
            width: 40px;
            height: 40px;
            background: transparent;
            border: 1px solid rgba(212, 175, 55, 0.5);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .menu-close:hover {
            background: var(--c-gold);
            border-color: var(--c-gold);
        }

        .menu-close:hover svg {
            stroke: #000;
        }

        .menu-close svg {
            width: 18px;
            height: 18px;
            stroke: var(--c-gold);
            stroke-width: 2;
        }

        .menu-panel .menu-close {
            right: 25px;
        }

        .menu-panel.right .menu-close {
            left: 25px;
            right: auto;
        }

        /* Divider */
        .menu-divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.3), transparent);
            margin: 20px 0;
        }

        /* Special highlight for free sessions */
        .menu-item.highlight {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(212, 175, 55, 0.05) 100%);
            border-color: var(--c-gold);
        }

        .menu-item.highlight::before {
            content: '★';
            position: absolute;
            top: -8px;
            right: 10px;
            color: var(--c-gold);
            font-size: 0.8rem;
        }

        /* HERO ORIGIN */
        #ui-origin { opacity: 1; }
        
        .hero-title {
            font-family: var(--font-head); 
            font-size: clamp(3rem, 8vw, 7rem);
            color: var(--c-gold); 
            text-transform: uppercase; 
            letter-spacing: 0.3em;
            text-shadow: 
                0 0 30px rgba(212, 175, 55, 0.5),
                0 0 60px rgba(212, 175, 55, 0.3),
                0 0 90px rgba(212, 175, 55, 0.1);
            animation: titleGlow 3s ease-in-out infinite;
        }
        
        @keyframes titleGlow {
            0%, 100% { text-shadow: 0 0 30px rgba(212, 175, 55, 0.5), 0 0 60px rgba(212, 175, 55, 0.3); }
            50% { text-shadow: 0 0 50px rgba(212, 175, 55, 0.8), 0 0 100px rgba(212, 175, 55, 0.5); }
        }
        
        .hero-subtitle {
            letter-spacing: 0.5em; 
            margin-top: 15px; 
            opacity: 0.7;
            font-size: clamp(0.8rem, 2vw, 1.2rem);
            color: var(--c-gold-glow);
        }
        
        .scroll-hint { 
            position: absolute; 
            bottom: 50px; 
            font-size: 0.75rem; 
            letter-spacing: 0.4em; 
            color: var(--c-gold); 
            animation: pulse 2s infinite;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }
        
        .scroll-hint::after {
            content: '';
            width: 1px;
            height: 40px;
            background: linear-gradient(to bottom, var(--c-gold), transparent);
            animation: scrollLine 2s infinite;
        }
        
        @keyframes scrollLine {
            0% { transform: scaleY(0); transform-origin: top; }
            50% { transform: scaleY(1); transform-origin: top; }
            51% { transform-origin: bottom; }
            100% { transform: scaleY(0); transform-origin: bottom; }
        }

        /* HUD IMPÉRIO */
        #ui-empire { 
            opacity: 0; 
            visibility: hidden; 
            pointer-events: none; 
        }
        
        .hud-top {
            position: absolute; 
            top: 30px; 
            width: 90%; 
            display: flex; 
            justify-content: space-between;
            border-top: 1px solid rgba(212,175,55,0.3); 
            padding-top: 15px; 
            color: var(--c-gold); 
            letter-spacing: 0.2em; 
            font-size: 0.7rem;
            padding-left: 80px;
            padding-right: 80px;
        }
        
        .hud-bottom {
            position: absolute;
            bottom: 30px;
            width: 90%;
            display: flex;
            justify-content: center;
            color: var(--c-gold);
            font-size: 0.65rem;
            letter-spacing: 0.3em;
            opacity: 0.6;
        }

        /* MARCADORES FUTURISTAS SCI-FI */
        .marker {
            position: fixed;
            display: flex; 
            flex-direction: column; 
            align-items: center;
            cursor: pointer; 
            pointer-events: none;
            opacity: 0;
            z-index: 20;
            transform: translate(-50%, -50%);
            transition: opacity 0.3s ease;
        }
        
        .marker.visible {
            opacity: 1;
            pointer-events: auto;
        }
        
        .marker-wrapper {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        /* Anel Externo Giratório */
        .marker-ring-outer {
            position: absolute;
            width: 70px;
            height: 70px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 2px solid transparent;
            border-top: 2px solid var(--c-gold);
            border-right: 2px solid var(--c-gold);
            border-radius: 50%;
            animation: rotateRing 4s linear infinite;
            opacity: 0.6;
            pointer-events: none;
        }
        
        .marker-ring-inner {
            position: absolute;
            width: 55px;
            height: 55px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 1px solid transparent;
            border-bottom: 1px solid var(--c-gold-bright);
            border-left: 1px solid var(--c-gold-bright);
            border-radius: 50%;
            animation: rotateRing 3s linear infinite reverse;
            opacity: 0.4;
            pointer-events: none;
        }
        
        @keyframes rotateRing {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }
        
        /* Ícone Central */
        .marker-icon {
            width: 44px; 
            height: 44px;
            background: radial-gradient(ellipse at center, rgba(15,15,20,0.95) 0%, rgba(0,0,0,0.9) 100%);
            border: 1.5px solid var(--c-gold);
            border-radius: 50%;
            display: flex; 
            justify-content: center; 
            align-items: center;
            box-shadow: 
                0 0 15px rgba(212, 175, 55, 0.5),
                0 0 30px rgba(212, 175, 55, 0.2),
                inset 0 0 15px rgba(212, 175, 55, 0.1);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            backdrop-filter: blur(10px);
            position: relative;
            z-index: 2;
        }
        
        .marker-icon svg { 
            width: 24px; 
            height: 24px; 
            transition: all 0.4s ease;
        }
        
        /* Nível Badge */
        .marker-level {
            position: absolute;
            top: -6px;
            right: -6px;
            background: linear-gradient(135deg, var(--c-gold) 0%, var(--c-gold-bright) 100%);
            color: #000;
            font-size: 0.55rem;
            font-weight: 700;
            padding: 2px 5px;
            border-radius: 3px;
            letter-spacing: 0.05em;
            z-index: 3;
            box-shadow: 0 0 8px var(--c-gold);
        }
        
        /* Label */
        .marker-label {
            margin-top: 10px; 
            font-size: 0.6rem; 
            letter-spacing: 0.2em;
            background: rgba(0,0,0,0.9); 
            color: var(--c-gold);
            padding: 5px 12px; 
            text-transform: uppercase;
            border: 1px solid rgba(212,175,55,0.5);
            opacity: 0; 
            transform: translateY(-10px) scale(0.9);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            backdrop-filter: blur(10px);
            white-space: nowrap;
            border-radius: 3px;
        }

        /* Hover States */
        .marker:hover .marker-icon { 
            transform: scale(1.2); 
            background: radial-gradient(ellipse at center, var(--c-gold) 0%, #b8960c 100%);
            box-shadow: 
                0 0 30px var(--c-gold),
                0 0 60px rgba(212, 175, 55, 0.6);
        }
        
        .marker:hover .marker-icon svg path,
        .marker:hover .marker-icon svg circle,
        .marker:hover .marker-icon svg line,
        .marker:hover .marker-icon svg ellipse { 
            fill: #000 !important;
            stroke: #000 !important;
        }
        
        .marker:hover .marker-label { 
            opacity: 1; 
            transform: translateY(0) scale(1); 
        }
        
        .marker:hover .marker-ring-outer,
        .marker:hover .marker-ring-inner {
            opacity: 1;
        }

        /* TRANSITION OVERLAY */
        #transition-overlay {
            position: fixed;
            inset: 0;
            background: radial-gradient(ellipse at center, transparent 0%, rgba(0,0,0,0.98) 100%);
            z-index: 150;
            opacity: 0;
            pointer-events: none;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .portal-ring {
            position: absolute;
            border: 2px solid var(--c-gold);
            border-radius: 50%;
            opacity: 0;
        }
        
        #transition-text {
            font-family: var(--font-head);
            font-size: clamp(1.2rem, 3vw, 2.5rem);
            color: var(--c-gold);
            letter-spacing: 0.3em;
            opacity: 0;
            text-shadow: 0 0 30px var(--c-gold);
            text-align: center;
        }
        
        #transition-deity {
            font-size: clamp(2rem, 5vw, 4rem);
            margin-bottom: 10px;
            display: block;
        }

        /* WHITE FLASH */
        #white-flash {
            position: fixed; 
            inset: 0; 
            background: radial-gradient(ellipse at center, #fff 0%, var(--c-gold-glow) 100%);
            z-index: 200;
            opacity: 0; 
            pointer-events: none;
        }

        /* LOADER */
        #loader {
            position: fixed; 
            inset: 0; 
            background: #000; 
            z-index: 999;
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center;
            font-family: var(--font-head); 
            color: var(--c-gold);
        }
        
        .loader-logo {
            font-size: 2rem;
            letter-spacing: 0.4em;
            margin-bottom: 30px;
            animation: titleGlow 2s ease-in-out infinite;
        }
        
        .bar { 
            width: 200px; 
            height: 2px; 
            background: rgba(212, 175, 55, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .progress { 
            width: 0%; 
            height: 100%; 
            background: linear-gradient(90deg, var(--c-gold), var(--c-gold-bright));
            transition: width 0.3s ease;
            box-shadow: 0 0 20px var(--c-gold);
        }
        
        .loader-status {
            margin-top: 20px;
            font-family: var(--font-tech);
            font-size: 0.7rem;
            letter-spacing: 0.3em;
            opacity: 0.6;
        }

        @keyframes pulse { 
            0%, 100% { opacity: 0.4; } 
            50% { opacity: 1; } 
        }
        
        /* Scan Lines Effect */
        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                rgba(0,0,0,0.02),
                rgba(0,0,0,0.02) 1px,
                transparent 1px,
                transparent 2px
            );
            pointer-events: none;
            z-index: 1000;
            opacity: 0.4;
        }
        
        /* Vignette */
        .vignette {
            position: fixed;
            inset: 0;
            background: radial-gradient(ellipse at center, transparent 40%, rgba(0,0,0,0.5) 100%);
            pointer-events: none;
            z-index: 5;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .menu-panel {
                width: 280px;
                padding: 90px 20px 30px;
            }
            
            .menu-toggle {
                width: 44px;
                height: 44px;
                top: 20px;
            }
            
            .menu-toggle-left {
                left: 15px;
            }
            
            .menu-toggle-right {
                right: 15px;
            }
            
            .menu-item {
                padding: 12px 15px;
            }
            
            .menu-item-icon {
                width: 35px;
                height: 35px;
            }
            
            .hud-top {
                padding-left: 60px;
                padding-right: 60px;
                font-size: 0.6rem;
            }
        }
    </style>
</head>
<body>

    <!-- Loader -->
    <div id="loader">
        <div class="loader-logo">AKASHA</div>
        <div class="bar"><div class="progress" id="prog-bar"></div></div>
        <div class="loader-status">INICIALIZANDO SISTEMA</div>
    </div>
    
    <!-- Effects Overlays -->
    <div class="scanlines"></div>
    <div class="vignette"></div>
    <div id="white-flash"></div>
    <div id="transition-overlay">
        <div class="portal-ring" style="width: 100px; height: 100px;"></div>
        <div class="portal-ring" style="width: 200px; height: 200px;"></div>
        <div class="portal-ring" style="width: 300px; height: 300px;"></div>
        <div class="portal-ring" style="width: 400px; height: 400px;"></div>
        <div id="transition-text">
            <span id="transition-deity">ANÚBIS</span>
            PORTAL ATIVADO
        </div>
    </div>

    <!-- ══════════════════════════════════════════════════════════════
         MENUS DE NAVEGAÇÃO
         ══════════════════════════════════════════════════════════════ -->
    
    <div class="nav-menus">
        <!-- Overlay -->
        <div class="menu-overlay" id="menuOverlay"></div>
        
        <!-- Toggle Button Left - Níveis -->
        <button class="menu-toggle menu-toggle-left" id="toggleLeft" aria-label="Menu Níveis">
            <svg viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10" stroke-width="1.5"/>
                <path d="M12 2 L12 6 M12 18 L12 22 M2 12 L6 12 M18 12 L22 12" stroke-width="1.5"/>
                <circle cx="12" cy="12" r="3" stroke-width="1.5"/>
            </svg>
        </button>
        
        <!-- Toggle Button Right - Páginas -->
        <button class="menu-toggle menu-toggle-right" id="toggleRight" aria-label="Menu Páginas">
            <svg viewBox="0 0 24 24">
                <line x1="3" y1="6" x2="21" y2="6" stroke-width="2"/>
                <line x1="3" y1="12" x2="21" y2="12" stroke-width="2"/>
                <line x1="3" y1="18" x2="21" y2="18" stroke-width="2"/>
            </svg>
        </button>
        
        <!-- Menu Panel Left - Níveis/Portais -->
        <nav class="menu-panel" id="menuLeft">
            <button class="menu-close" id="closeLeft" aria-label="Fechar menu">
                <svg viewBox="0 0 24 24">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
            
            <div class="menu-header">◈ Portais ◈</div>
            
            <a href="https://akashahub.com.br" class="menu-item" data-deity="anubis">
                <div class="menu-item-icon" id="menuIconAnubis"></div>
                <div class="menu-item-content">
                    <div class="menu-item-title">Anúbis</div>
                    <div class="menu-item-subtitle">Guardião do Sul</div>
                </div>
                <div class="menu-item-level">N1</div>
            </a>
            
            <a href="https://akashahub.com.br" class="menu-item" data-deity="horus">
                <div class="menu-item-icon" id="menuIconHorus"></div>
                <div class="menu-item-content">
                    <div class="menu-item-title">Hórus</div>
                    <div class="menu-item-subtitle">Guardião do Norte</div>
                </div>
                <div class="menu-item-level">N2</div>
            </a>
            
            <a href="https://akashahub.com.br" class="menu-item" data-deity="isis">
                <div class="menu-item-icon" id="menuIconIsis"></div>
                <div class="menu-item-content">
                    <div class="menu-item-title">Ísis</div>
                    <div class="menu-item-subtitle">Guardiã do Oeste</div>
                </div>
                <div class="menu-item-level">N3</div>
            </a>
            
            <a href="https://akashahub.com.br" class="menu-item" data-deity="ra">
                <div class="menu-item-icon" id="menuIconRa"></div>
                <div class="menu-item-content">
                    <div class="menu-item-title">Rá</div>
                    <div class="menu-item-subtitle">Guardião do Leste</div>
                </div>
                <div class="menu-item-level">N4</div>
            </a>
            
            <div class="menu-footer">
                <div class="menu-footer-text">AKASHA EMPIRE</div>
            </div>
        </nav>
        
        <!-- Menu Panel Right - Páginas -->
        <nav class="menu-panel right" id="menuRight">
            <button class="menu-close" id="closeRight" aria-label="Fechar menu">
                <svg viewBox="0 0 24 24">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
            
            <div class="menu-header">◈ Navegação ◈</div>
            
            <a href="https://akashahub.com.br/mentoria" class="menu-item">
                <div class="menu-item-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#d4af37" stroke-width="1.5">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                        <path d="M2 17l10 5 10-5"/>
                        <path d="M2 12l10 5 10-5"/>
                    </svg>
                </div>
                <div class="menu-item-content">
                    <div class="menu-item-title">Mentoria</div>
                    <div class="menu-item-subtitle">Programa de desenvolvimento</div>
                </div>
            </a>
            
            <a href="https://akashahub.com.br/vip" class="menu-item">
                <div class="menu-item-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#d4af37" stroke-width="1.5">
                        <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                    </svg>
                </div>
                <div class="menu-item-content">
                    <div class="menu-item-title">Presencial VIP</div>
                    <div class="menu-item-subtitle">Experiência exclusiva</div>
                </div>
            </a>
            
            <a href="https://akashahub.com.br/partners" class="menu-item">
                <div class="menu-item-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#d4af37" stroke-width="1.5">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                        <circle cx="9" cy="7" r="4"/>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                    </svg>
                </div>
                <div class="menu-item-content">
                    <div class="menu-item-title">Parceiros</div>
                    <div class="menu-item-subtitle">Patrocinadores & parcerias</div>
                </div>
            </a>
            
            <div class="menu-divider"></div>
            
            <a href="https://akashahub.com.br/livre/" class="menu-item highlight" style="position: relative;">
                <div class="menu-item-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#d4af37" stroke-width="1.5">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M8 14s1.5 2 4 2 4-2 4-2"/>
                        <line x1="9" y1="9" x2="9.01" y2="9"/>
                        <line x1="15" y1="9" x2="15.01" y2="9"/>
                    </svg>
                </div>
                <div class="menu-item-content">
                    <div class="menu-item-title">Sessões Grátis</div>
                    <div class="menu-item-subtitle">Grupos online abertos</div>
                </div>
            </a>
            
            <div class="menu-footer">
                <div class="menu-footer-text">IMPÉRIO DIGITAL</div>
            </div>
        </nav>
    </div>

    <!-- WebGL Canvas -->
    <canvas id="stage"></canvas>
    
    <!-- Scroll Track -->
    <div class="scroll-track"></div>

    <!-- UI: Origem -->
    <div id="ui-origin" class="ui-layer">
        <h1 class="hero-title">Akasha</h1>
        <div class="hero-subtitle">IMPÉRIO DIGITAL</div>
        <div class="scroll-hint">INICIAR ASCENSÃO</div>
    </div>

    <!-- UI: Império -->
    <div id="ui-empire" class="ui-layer">
        <div class="hud-top">
            <div>◈ ORBITAL CONTROL: ACTIVE</div>
            <div>◈ SYSTEM STATUS: ONLINE</div>
        </div>
        <div id="marker-container"></div>
        <div class="hud-bottom">
            <div>SELECIONE UM PORTAL PARA CONTINUAR</div>
        </div>
    </div>

    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <script>
        // ══════════════════════════════════════════════════════════════
        //  AKASHA ENGINE v3.0 - CINEMATIC EARTH EXPERIENCE
        //  Com Menus de Navegação
        // ══════════════════════════════════════════════════════════════

        // ─────────────────────────────────────────────────────────────
        // MENU NAVIGATION SYSTEM
        // ─────────────────────────────────────────────────────────────
        
        const menuSystem = {
            overlay: document.getElementById('menuOverlay'),
            menuLeft: document.getElementById('menuLeft'),
            menuRight: document.getElementById('menuRight'),
            toggleLeft: document.getElementById('toggleLeft'),
            toggleRight: document.getElementById('toggleRight'),
            closeLeft: document.getElementById('closeLeft'),
            closeRight: document.getElementById('closeRight'),
            
            init() {
                // Toggle buttons
                this.toggleLeft.addEventListener('click', () => this.openMenu('left'));
                this.toggleRight.addEventListener('click', () => this.openMenu('right'));
                
                // Close buttons
                this.closeLeft.addEventListener('click', () => this.closeMenu('left'));
                this.closeRight.addEventListener('click', () => this.closeMenu('right'));
                
                // Overlay click
                this.overlay.addEventListener('click', () => this.closeAll());
                
                // ESC key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') this.closeAll();
                });
            },
            
            openMenu(side) {
                this.closeAll();
                this.overlay.classList.add('active');
                if (side === 'left') {
                    this.menuLeft.classList.add('open');
                } else {
                    this.menuRight.classList.add('open');
                }
            },
            
            closeMenu(side) {
                this.overlay.classList.remove('active');
                if (side === 'left') {
                    this.menuLeft.classList.remove('open');
                } else {
                    this.menuRight.classList.remove('open');
                }
            },
            
            closeAll() {
                this.overlay.classList.remove('active');
                this.menuLeft.classList.remove('open');
                this.menuRight.classList.remove('open');
            }
        };
        
        // Initialize menu system
        menuSystem.init();

        // ─────────────────────────────────────────────────────────────
        // CONFIGURAÇÃO GLOBAL
        // ─────────────────────────────────────────────────────────────
        
        const CONFIG = {
            earthRadius: 3.5,
            markerOffset: 0.15,
            cameraDistance: 12,
            targetLocation: {
                lat: 30.0444,
                lon: 31.2357
            },
            textures: {
                map: 'https://unpkg.com/three-globe/example/img/earth-blue-marble.jpg',
                bump: 'https://unpkg.com/three-globe/example/img/earth-topology.png',
                specular: 'https://unpkg.com/three-globe/example/img/earth-water.png'
            }
        };

        // ─────────────────────────────────────────────────────────────
        // ÍCONES SVG DOS DEUSES EGÍPCIOS
        // ─────────────────────────────────────────────────────────────
        
        const DEITY_ICONS = {
            anubis: `<svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="anubisGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#ffd700"/>
                        <stop offset="50%" style="stop-color:#d4af37"/>
                        <stop offset="100%" style="stop-color:#b8860b"/>
                    </linearGradient>
                </defs>
                <path fill="url(#anubisGrad)" d="M32 8 L26 18 L22 14 L24 24 L18 22 L22 30 L16 32 L22 36 L18 42 L26 40 L28 48 L32 44 L36 48 L38 40 L46 42 L42 36 L48 32 L42 30 L46 22 L40 24 L42 14 L38 18 Z"/>
                <circle cx="32" cy="28" r="5" fill="#0a0a0a" stroke="url(#anubisGrad)" stroke-width="1.5"/>
                <circle cx="32" cy="28" r="2" fill="url(#anubisGrad)"/>
                <ellipse cx="32" cy="52" rx="4" ry="3" fill="none" stroke="url(#anubisGrad)" stroke-width="1.5"/>
                <line x1="32" y1="55" x2="32" y2="62" stroke="url(#anubisGrad)" stroke-width="1.5"/>
                <line x1="28" y1="58" x2="36" y2="58" stroke="url(#anubisGrad)" stroke-width="1.5"/>
            </svg>`,
            
            horus: `<svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="horusGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#ffd700"/>
                        <stop offset="100%" style="stop-color:#d4af37"/>
                    </linearGradient>
                </defs>
                <ellipse cx="32" cy="26" rx="20" ry="12" fill="none" stroke="url(#horusGrad)" stroke-width="2"/>
                <circle cx="32" cy="26" r="7" fill="url(#horusGrad)"/>
                <circle cx="32" cy="26" r="3.5" fill="#0a0a0a"/>
                <circle cx="33" cy="25" r="1.5" fill="url(#horusGrad)"/>
                <path fill="none" stroke="url(#horusGrad)" stroke-width="2" d="M12 26 Q8 32 6 42"/>
                <path fill="none" stroke="url(#horusGrad)" stroke-width="2" d="M52 26 Q56 32 58 42"/>
                <path fill="none" stroke="url(#horusGrad)" stroke-width="1.5" d="M16 16 L32 12 L48 16"/>
                <path fill="url(#horusGrad)" d="M26 38 L32 50 L38 38 L35 40 L32 38 L29 40 Z"/>
            </svg>`,
            
            isis: `<svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="isisGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#ffd700"/>
                        <stop offset="100%" style="stop-color:#d4af37"/>
                    </linearGradient>
                </defs>
                <path fill="url(#isisGrad)" d="M28 6 L32 2 L36 6 L36 14 L28 14 Z"/>
                <circle cx="32" cy="20" r="5" fill="url(#isisGrad)"/>
                <line x1="32" y1="25" x2="32" y2="42" stroke="url(#isisGrad)" stroke-width="2"/>
                <path fill="url(#isisGrad)" opacity="0.9" d="M32 30 L4 22 L6 30 L2 38 L32 34 L62 38 L58 30 L60 22 Z"/>
                <path fill="none" stroke="url(#isisGrad)" stroke-width="0.8" d="M8 26 L28 31"/>
                <path fill="none" stroke="url(#isisGrad)" stroke-width="0.8" d="M56 26 L36 31"/>
                <path fill="none" stroke="url(#isisGrad)" stroke-width="0.8" d="M6 34 L28 33"/>
                <path fill="none" stroke="url(#isisGrad)" stroke-width="0.8" d="M58 34 L36 33"/>
                <path fill="url(#isisGrad)" d="M26 42 L32 62 L38 42 Z" opacity="0.8"/>
            </svg>`,
            
            ra: `<svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <radialGradient id="raGrad" cx="50%" cy="50%" r="50%">
                        <stop offset="0%" style="stop-color:#ffffff"/>
                        <stop offset="30%" style="stop-color:#ffd700"/>
                        <stop offset="70%" style="stop-color:#d4af37"/>
                        <stop offset="100%" style="stop-color:#b8860b"/>
                    </radialGradient>
                </defs>
                <circle cx="32" cy="32" r="10" fill="url(#raGrad)"/>
                <circle cx="32" cy="32" r="14" fill="none" stroke="#d4af37" stroke-width="1" opacity="0.7"/>
                <circle cx="32" cy="32" r="18" fill="none" stroke="#d4af37" stroke-width="0.5" opacity="0.5"/>
                <line x1="32" y1="2" x2="32" y2="12" stroke="#d4af37" stroke-width="2.5"/>
                <line x1="32" y1="52" x2="32" y2="62" stroke="#d4af37" stroke-width="2.5"/>
                <line x1="2" y1="32" x2="12" y2="32" stroke="#d4af37" stroke-width="2.5"/>
                <line x1="52" y1="32" x2="62" y2="32" stroke="#d4af37" stroke-width="2.5"/>
                <line x1="8" y1="8" x2="16" y2="16" stroke="#d4af37" stroke-width="2"/>
                <line x1="48" y1="48" x2="56" y2="56" stroke="#d4af37" stroke-width="2"/>
                <line x1="56" y1="8" x2="48" y2="16" stroke="#d4af37" stroke-width="2"/>
                <line x1="8" y1="56" x2="16" y2="48" stroke="#d4af37" stroke-width="2"/>
                <circle cx="32" cy="32" r="4" fill="#fff" opacity="0.9"/>
            </svg>`
        };

        // Inject icons into menu
        document.getElementById('menuIconAnubis').innerHTML = DEITY_ICONS.anubis;
        document.getElementById('menuIconHorus').innerHTML = DEITY_ICONS.horus;
        document.getElementById('menuIconIsis').innerHTML = DEITY_ICONS.isis;
        document.getElementById('menuIconRa').innerHTML = DEITY_ICONS.ra;

        // ─────────────────────────────────────────────────────────────
        // DADOS DOS MARCADORES
        // ─────────────────────────────────────────────────────────────
        
        const MARKERS_DATA = [
            { 
                id: 'anubis', 
                name: 'Anúbis',
                level: 1,
                position: 'south',
                lat: -75, 
                lon: 0, 
                icon: DEITY_ICONS.anubis, 
                label: "ANÚBIS",
                url: 'https://akashahub.com.br'
            },
            { 
                id: 'horus', 
                name: 'Hórus',
                level: 2,
                position: 'north',
                lat: 75, 
                lon: 0, 
                icon: DEITY_ICONS.horus, 
                label: "HÓRUS",
                url: 'https://akashahub.com.br'
            },
            { 
                id: 'isis', 
                name: 'Ísis',
                level: 3,
                position: 'west',
                lat: 0, 
                lon: -90, 
                icon: DEITY_ICONS.isis, 
                label: "ÍSIS",
                url: 'https://akashahub.com.br'
            },
            { 
                id: 'ra', 
                name: 'Rá',
                level: 4,
                position: 'east',
                lat: 0, 
                lon: 90, 
                icon: DEITY_ICONS.ra, 
                label: "RÁ",
                url: 'https://akashahub.com.br'
            }
        ];

        // ─────────────────────────────────────────────────────────────
        // SHADERS
        // ─────────────────────────────────────────────────────────────
        
        const SHADERS = {
            atmosphere: {
                vertex: `
                    varying vec3 vNormal;
                    void main() {
                        vNormal = normalize(normalMatrix * normal);
                        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
                    }
                `,
                fragment: `
                    varying vec3 vNormal;
                    uniform float uIntensity;
                    void main() {
                        float intensity = pow(0.65 - dot(vNormal, vec3(0, 0, 1.0)), 2.0);
                        vec3 color = mix(vec3(0.2, 0.5, 1.0), vec3(0.1, 0.8, 1.0), intensity);
                        gl_FragColor = vec4(color, intensity * uIntensity);
                    }
                `
            },
            
            pyramid: {
                vertex: `
                    varying vec2 vUv;
                    void main() {
                        vUv = uv;
                        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
                    }
                `,
                fragment: `
                    uniform float uTime;
                    varying vec2 vUv;
                    void main() {
                        float grid = step(0.92, fract(vUv.y * 25.0 - uTime * 0.15));
                        vec3 baseColor = vec3(0.05, 0.05, 0.08);
                        vec3 glowColor = vec3(0.83, 0.68, 0.21);
                        vec3 color = mix(baseColor, glowColor, grid);
                        gl_FragColor = vec4(color, 1.0);
                    }
                `
            },
            
            beam: {
                vertex: `
                    varying vec2 vUv;
                    void main() {
                        vUv = uv;
                        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
                    }
                `,
                fragment: `
                    uniform float uTime;
                    uniform float uIntensity;
                    varying vec2 vUv;
                    void main() {
                        float beam = 1.0 - abs(vUv.x - 0.5) * 2.0;
                        beam = pow(beam, 3.0);
                        float flow = sin(vUv.y * 30.0 - uTime * 8.0) * 0.5 + 0.5;
                        float pulse = sin(uTime * 2.0) * 0.3 + 0.7;
                        vec3 color = mix(vec3(0.3, 0.6, 1.0), vec3(0.8, 0.9, 1.0), flow);
                        gl_FragColor = vec4(color, beam * flow * uIntensity * pulse);
                    }
                `
            }
        };

        // ─────────────────────────────────────────────────────────────
        // INICIALIZAÇÃO THREE.JS
        // ─────────────────────────────────────────────────────────────
        
        const canvas = document.querySelector('#stage');
        const renderer = new THREE.WebGLRenderer({ 
            canvas, 
            antialias: true,
            alpha: true,
            powerPreference: 'high-performance'
        });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.toneMapping = THREE.ACESFilmicToneMapping;
        renderer.toneMappingExposure = 1.2;
        
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 0, CONFIG.cameraDistance);

        // Iluminação
        const ambientLight = new THREE.AmbientLight(0x404040, 0.5);
        scene.add(ambientLight);
        
        const sunLight = new THREE.DirectionalLight(0xffffff, 1.8);
        sunLight.position.set(5, 3, 5);
        scene.add(sunLight);
        
        const rimLight = new THREE.DirectionalLight(0x4aa3ff, 0.4);
        rimLight.position.set(-5, 0, -5);
        scene.add(rimLight);

        // ─────────────────────────────────────────────────────────────
        // GRUPOS DE OBJETOS
        // ─────────────────────────────────────────────────────────────
        
        const earthGroup = new THREE.Group();
        const pyramidGroup = new THREE.Group();
        scene.add(earthGroup);
        scene.add(pyramidGroup);

        // ─────────────────────────────────────────────────────────────
        // TERRA REALISTA
        // ─────────────────────────────────────────────────────────────
        
        const texLoader = new THREE.TextureLoader();
        let loadedTextures = 0;
        const totalTextures = 3;

        function updateLoadingProgress() {
            loadedTextures++;
            const progress = (loadedTextures / totalTextures) * 100;
            document.getElementById('prog-bar').style.width = progress + '%';
            
            if (loadedTextures >= totalTextures) {
                setTimeout(() => {
                    gsap.to('#loader', { 
                        opacity: 0, 
                        duration: 1, 
                        onComplete: () => document.getElementById('loader').remove() 
                    });
                }, 500);
            }
        }

        const earthGeo = new THREE.SphereGeometry(CONFIG.earthRadius, 64, 64);
        const earthMat = new THREE.MeshPhongMaterial({
            map: texLoader.load(CONFIG.textures.map, updateLoadingProgress),
            bumpMap: texLoader.load(CONFIG.textures.bump, updateLoadingProgress),
            bumpScale: 0.05,
            specularMap: texLoader.load(CONFIG.textures.specular, updateLoadingProgress),
            specular: new THREE.Color(0x333333),
            shininess: 15
        });
        const earth = new THREE.Mesh(earthGeo, earthMat);
        earthGroup.add(earth);

        // Atmosfera
        const atmoGeo = new THREE.SphereGeometry(CONFIG.earthRadius + 0.15, 64, 64);
        const atmoMat = new THREE.ShaderMaterial({
            vertexShader: SHADERS.atmosphere.vertex,
            fragmentShader: SHADERS.atmosphere.fragment,
            uniforms: { uIntensity: { value: 1.5 } },
            side: THREE.BackSide,
            blending: THREE.AdditiveBlending,
            transparent: true,
            depthWrite: false
        });
        const atmosphere = new THREE.Mesh(atmoGeo, atmoMat);
        earthGroup.add(atmosphere);

        earthGroup.position.set(0, 6, 0);

        // ─────────────────────────────────────────────────────────────
        // PIRÂMIDE
        // ─────────────────────────────────────────────────────────────
        
        const pyrGeo = new THREE.ConeGeometry(2, 3, 4);
        const pyrMat = new THREE.ShaderMaterial({
            vertexShader: SHADERS.pyramid.vertex,
            fragmentShader: SHADERS.pyramid.fragment,
            uniforms: { uTime: { value: 0 } }
        });
        const pyramid = new THREE.Mesh(pyrGeo, pyrMat);
        pyramidGroup.position.set(0, -5, 0);
        pyramidGroup.add(pyramid);

        // ─────────────────────────────────────────────────────────────
        // FEIXE DE LUZ
        // ─────────────────────────────────────────────────────────────
        
        const beamGeo = new THREE.CylinderGeometry(0.03, 0.15, 11, 32, 1, true);
        const beamMat = new THREE.ShaderMaterial({
            vertexShader: SHADERS.beam.vertex,
            fragmentShader: SHADERS.beam.fragment,
            uniforms: { 
                uTime: { value: 0 }, 
                uIntensity: { value: 0.5 } 
            },
            transparent: true,
            blending: THREE.AdditiveBlending,
            side: THREE.DoubleSide,
            depthWrite: false
        });
        const beam = new THREE.Mesh(beamGeo, beamMat);
        beam.position.y = 0.5;
        scene.add(beam);

        // ─────────────────────────────────────────────────────────────
        // ESTRELAS
        // ─────────────────────────────────────────────────────────────
        
        const starsGeo = new THREE.BufferGeometry();
        const starsCount = 5000;
        const posArray = new Float32Array(starsCount * 3);
        
        for (let i = 0; i < starsCount; i++) {
            const i3 = i * 3;
            posArray[i3] = (Math.random() - 0.5) * 150;
            posArray[i3 + 1] = (Math.random() - 0.5) * 150;
            posArray[i3 + 2] = (Math.random() - 0.5) * 150;
        }
        
        starsGeo.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
        
        const starsMat = new THREE.PointsMaterial({
            color: 0xffffff,
            size: 0.08,
            transparent: true,
            opacity: 0.9,
            sizeAttenuation: true
        });
        const stars = new THREE.Points(starsGeo, starsMat);
        scene.add(stars);

        // ─────────────────────────────────────────────────────────────
        // FUNÇÃO DE CONVERSÃO LAT/LON PARA VECTOR3
        // ─────────────────────────────────────────────────────────────
        
        function latLonToVector3(lat, lon, radius) {
            const phi = (90 - lat) * (Math.PI / 180);
            const theta = (lon + 180) * (Math.PI / 180);
            
            const x = -radius * Math.sin(phi) * Math.cos(theta);
            const y = radius * Math.cos(phi);
            const z = radius * Math.sin(phi) * Math.sin(theta);
            
            return new THREE.Vector3(x, y, z);
        }

        // ─────────────────────────────────────────────────────────────
        // CRIAÇÃO DOS MARCADORES HTML
        // ─────────────────────────────────────────────────────────────
        
        const markers = [];
        const markerContainer = document.getElementById('marker-container');

        MARKERS_DATA.forEach(data => {
            const el = document.createElement('div');
            el.className = 'marker';
            el.id = `marker-${data.id}`;
            el.innerHTML = `
                <div class="marker-wrapper">
                    <div class="marker-ring-outer"></div>
                    <div class="marker-ring-inner"></div>
                    <div class="marker-icon">${data.icon}</div>
                    <div class="marker-level">N${data.level}</div>
                    <div class="marker-label">${data.label} • NÍVEL ${data.level}</div>
                </div>
            `;
            el.addEventListener('click', (e) => startPortalTransition(data, e));
            markerContainer.appendChild(el);
            
            const localPos = latLonToVector3(data.lat, data.lon, CONFIG.earthRadius + CONFIG.markerOffset);
            
            markers.push({ 
                element: el, 
                localPos: localPos,
                data: data 
            });
        });

        // ─────────────────────────────────────────────────────────────
        // ATUALIZAÇÃO DE POSIÇÃO DOS MARCADORES
        // ─────────────────────────────────────────────────────────────
        
        function updateMarkersPosition() {
            const tempV = new THREE.Vector3();
            
            markers.forEach(marker => {
                tempV.copy(marker.localPos);
                earthGroup.localToWorld(tempV);
                
                const screenPos = tempV.clone().project(camera);
                
                const isBehindCamera = screenPos.z > 1;
                
                const dirToMarker = tempV.clone().sub(camera.position).normalize();
                const raycaster = new THREE.Raycaster(camera.position, dirToMarker);
                const intersects = raycaster.intersectObject(earth);
                
                const distToMarker = camera.position.distanceTo(tempV);
                const isOccluded = intersects.length > 0 && intersects[0].distance < distToMarker - 0.5;
                
                if (!isBehindCamera && !isOccluded) {
                    const x = (screenPos.x * 0.5 + 0.5) * window.innerWidth;
                    const y = (-screenPos.y * 0.5 + 0.5) * window.innerHeight;
                    
                    const scale = Math.max(0.5, Math.min(1.0, 6 / distToMarker));
                    
                    marker.element.style.left = `${x}px`;
                    marker.element.style.top = `${y}px`;
                    marker.element.style.transform = `translate(-50%, -50%) scale(${scale})`;
                    marker.element.classList.add('visible');
                } else {
                    marker.element.classList.remove('visible');
                }
            });
        }

        // ─────────────────────────────────────────────────────────────
        // TRANSIÇÃO DO PORTAL
        // ─────────────────────────────────────────────────────────────
        
        let controls;
        let isInteractive = false;
        let isTransitioning = false;

        function startPortalTransition(data, event) {
            if (isTransitioning) return;
            isTransitioning = true;
            if (event) event.stopPropagation();
            
            // Close any open menu
            menuSystem.closeAll();
            
            if (controls) controls.enabled = false;
            document.body.style.cursor = 'wait';
            
            document.getElementById('transition-deity').textContent = data.name.toUpperCase();
            
            markers.forEach(m => {
                m.element.classList.remove('visible');
            });
            
            const targetRotationY = -(CONFIG.targetLocation.lon) * (Math.PI / 180) + Math.PI;
            
            const tl = gsap.timeline();
            
            tl.to('#transition-overlay', { opacity: 1, duration: 0.5 }, 0);
            
            tl.to('.portal-ring', {
                opacity: 0.8,
                scale: 1.5,
                duration: 1.2,
                stagger: 0.15,
                ease: "power2.out"
            }, 0.2);
            
            tl.to(earthGroup.rotation, {
                y: targetRotationY,
                duration: 2.5,
                ease: "power2.inOut"
            }, 0.3);
            
            tl.to(camera.position, {
                z: 6,
                y: earthGroup.position.y + 0.5,
                duration: 2,
                ease: "power2.inOut"
            }, 0.5);
            
            tl.to('#transition-text', {
                opacity: 1,
                duration: 0.8,
                ease: "power2.out"
            }, 1.8);
            
            tl.to(camera.position, {
                z: 3,
                duration: 1.5,
                ease: "power2.in"
            }, 2.5);
            
            tl.to('#white-flash', {
                opacity: 1,
                duration: 0.6,
                ease: "power2.in"
            }, 3.5);
            
            tl.call(() => {
                window.location.href = data.url;
            }, null, 4.2);
        }

        // ─────────────────────────────────────────────────────────────
        // HABILITA INTERAÇÃO ORBITAL
        // ─────────────────────────────────────────────────────────────
        
        function enableInteraction() {
            if (isInteractive) return;
            isInteractive = true;
            document.body.style.cursor = 'grab';
            
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.enableZoom = true;
            controls.minDistance = 5;
            controls.maxDistance = 15;
            controls.rotateSpeed = 0.4;
            controls.target.copy(earthGroup.position);
            controls.enablePan = false;
            
            gsap.to('#ui-empire', { 
                autoAlpha: 1, 
                duration: 1.5,
                ease: "power2.out"
            });
        }

        // ─────────────────────────────────────────────────────────────
        // SCROLL ANIMATION
        // ─────────────────────────────────────────────────────────────
        
        gsap.registerPlugin(ScrollTrigger);

        const scrollTL = gsap.timeline({
            scrollTrigger: {
                trigger: ".scroll-track",
                start: "top top",
                end: "bottom bottom",
                scrub: 1.5,
                onLeave: enableInteraction,
                onLeaveBack: () => {
                    if (isInteractive) {
                        isInteractive = false;
                        if (controls) controls.dispose();
                        gsap.to('#ui-empire', { autoAlpha: 0, duration: 0.5 });
                        gsap.to('#ui-origin', { opacity: 1, duration: 0.5 });
                        markers.forEach(m => m.element.classList.remove('visible'));
                    }
                }
            }
        });

        // FASE 1: Ativação
        scrollTL.to(camera.position, { z: 10, duration: 1.5 }, 0);
        scrollTL.to(beamMat.uniforms.uIntensity, { value: 3.0, duration: 1.5 }, 0);
        scrollTL.to('#ui-origin', { opacity: 0, duration: 0.8 }, 0);

        // FASE 2: Barrel Roll
        scrollTL.to(camera.rotation, { z: Math.PI * 2, duration: 3, ease: "power2.inOut" }, 1.5);
        scrollTL.to(camera.position, { z: 3, y: 2, duration: 2.5, ease: "power1.in" }, 1.5);
        scrollTL.to(stars.scale, { z: 8, duration: 2 }, 2);
        scrollTL.to(beamMat.uniforms.uIntensity, { value: 0, duration: 0.8 }, 3);

        // FASE 3: Chegada
        scrollTL.to(stars.scale, { z: 1, x: 1, y: 1, duration: 1.5 }, 4);
        scrollTL.to(camera.position, { x: 0, y: earthGroup.position.y, z: 10, duration: 2 }, 4);
        scrollTL.to(camera.rotation, { x: 0, y: 0, z: 0, duration: 1.5 }, 5);

        // ─────────────────────────────────────────────────────────────
        // LOOP DE RENDERIZAÇÃO
        // ─────────────────────────────────────────────────────────────
        
        const clock = new THREE.Clock();

        function animate() {
            const time = clock.getElapsedTime();
            
            pyrMat.uniforms.uTime.value = time;
            beamMat.uniforms.uTime.value = time;
            
            if (!isInteractive && !isTransitioning) {
                earthGroup.rotation.y = time * 0.03;
                pyramidGroup.rotation.y = -time * 0.08;
                stars.rotation.y = time * 0.005;
            } else if (controls && !isTransitioning) {
                controls.update();
            }

            if (isInteractive && !isTransitioning) {
                updateMarkersPosition();
            }

            renderer.render(scene, camera);
            requestAnimationFrame(animate);
        }

        animate();

        // ─────────────────────────────────────────────────────────────
        // RESPONSIVIDADE
        // ─────────────────────────────────────────────────────────────
        
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        document.body.addEventListener('touchmove', (e) => {
            if (e.target === document.body) e.preventDefault();
        }, { passive: false });

    </script>
</body>
</html>
